Index: SYEI_stamping_press_system/TEST.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import main_program as mprog\r\nimport datetime, time, math\r\nimport drafting as draft\r\nimport parameter as par\r\n\r\ni = 5\r\n# #\r\n# # mprog.switch_window()\r\n# #\r\n# # # 隱藏機架外零件\r\n# # for part_name in par.hide_part_name:\r\n# #     mprog.hide_show_part(part_name, 1)\r\n#\r\n# # 投影\r\n# # mprog.switch_window()\r\ndrafting_down_Coordinate_Position, drafting_up_Coordinate_Position, scale = draft.drafting_welding_view_parameter_calculation(\r\n    par.A[i], par.B[i], par.H[i], par.S[i], par.Z[i], par.T[i])\r\ndraft.change_Drawing_scale(1 / scale)\r\n# # 副程式名稱須注意是否與立體圖相符\r\n# draft.Front_View_Drawing('SN1-110', drafting_down_Coordinate_Position['Right View'][0],\r\n#                          drafting_down_Coordinate_Position['Right View'][1], scale)  # 左側試圖\r\n# draft.Right_View_Drawing('SN1-110', drafting_down_Coordinate_Position['Front View'][0],\r\n#                          drafting_down_Coordinate_Position['Front View'][1], scale)  # 前視圖\r\n# draft.Right_Top_View_Drawing('SN1-110', drafting_up_Coordinate_Position['Top View'][0],\r\n#                              drafting_up_Coordinate_Position['Top View'][1], scale)  # 上視圖\r\n#\r\n# # 剖面圖座標\r\n# Section_Coordinate = {'A-A': [[float(0), float(-2900), float(0), float(600)], 1],\r\n#                       'B-B': [[float(par.B[i] + 100), float(520), float(par.B[i] + 100), float(-1200)], 0],\r\n#                       'C-C': [[float(-195), float(-par.S[i] + 100), float(par.B[i] + 100), float(-par.S[i] + 100)], 0],\r\n#                       'D-D': [[float(-par.A[i] / 2 - 100), float(-par.H[i] / 2), float(par.A[i] / 2 + 100),\r\n#                                float(-par.H[i] / 2)], 1],\r\n#                       'E-E': [[float(-100), float(-(par.S[i] + par.Z[i]) + 100), float(par.B[i] / 3),\r\n#                                float(-(par.S[i] + par.Z[i]) + 100)], 0],\r\n#                       'F-F': [[float(272), float(- 176 / 2), float(272), float(-176 * 3 / 2)], 0],\r\n#                       'G-G': [[float(par.B[i] + 100), float(-(par.S[i] + par.Z[i]) + 200), float(par.B[i] + 100),\r\n#                                float(-(par.S[i] + par.Z[i]) - 200)], 0]}\r\n# Section_Coordinate_title = list(Section_Coordinate.keys())\r\n# view_order = ['Front view', 'Right view', 'Section view A-A', 'Front view', 'Right view', 'Section view B-B',\r\n#               'Section view A-A']\r\n# for title in Section_Coordinate_title:\r\n#     for view_name in view_order:\r\n#         if 'Section view ' + title in drafting_up_Coordinate_Position:  # 若此元素為此字典之鍵則執行\r\n#             draft.Section(view_name, drafting_up_Coordinate_Position['Section view ' + title][0],\r\n#                           drafting_up_Coordinate_Position['Section view ' + title][1], scale,\r\n#                           Section_Coordinate[title][0],\r\n#                           Section_Coordinate[title][1], 'Section view ' + title)\r\n#         else:\r\n#             draft.Section(view_name, drafting_down_Coordinate_Position['Section view ' + title][0],\r\n#                           drafting_down_Coordinate_Position['Section view ' + title][1], scale,\r\n#                           Section_Coordinate[title][0],\r\n#                           Section_Coordinate[title][1], 'Section view ' + title)\r\n#         view_order.pop(0)  # 刪除串列中第一個元素\r\n#         break\r\n#\r\n# # # 裁切選定圖面範圍\r\n# detail_view_coordinate = {\r\n#     'Section view D-D': [float(par.A[i] / 2), float(-270), float(-par.A[i] / 2), float(-270), float(-par.A[i] / 2),\r\n#                          float(-630), float(par.A[i] / 2), float(-630)],\r\n#     'Section view F-F': [float(-979 + 42), float(-25), float(-979 + 42), float(-290), float(-54 - 979), float(-290),\r\n#                          float(-979 - 54), float(-25)],\r\n#     'Section view G-G': [float(-par.A[i] / 2 - par.FRAME_6_7_width[i]), float(-par.S[i] - par.Z[i] + 150),\r\n#                          float(-par.A[i] / 2 - par.FRAME_6_7_width[i]),\r\n#                          float(-par.S[i] - par.Z[i] - 150), float(-par.A[i] / 2 + par.FRAME_6_7_width[i] + 170),\r\n#                          float(-par.S[i] - par.Z[i] - 150), float(-par.A[i] / 2 + par.FRAME_6_7_width[i] + 170),\r\n#                          float(-par.S[i] - par.Z[i] + 150)]}\r\n# detail_view_coordinate_keys = list(detail_view_coordinate.keys())\r\n# for coordinate_keys in detail_view_coordinate_keys:\r\n#     if coordinate_keys == 'Section view F-F' or coordinate_keys == 'Section view D-D':\r\n#         mprog.switch_window()\r\n#         if coordinate_keys == 'Section view F-F':\r\n#             for name in par.part_name_Section_view_F_F:\r\n#                 mprog.hide_show_part(name, 1)\r\n#         elif coordinate_keys == 'Section view D-D':\r\n#             for name in par.part_name_Section_view_D_D:\r\n#                 mprog.hide_show_part(name, 1)\r\n#         mprog.switch_window()\r\n#         if coordinate_keys in drafting_up_Coordinate_Position:\r\n#             draft.Define_Polygonal_Detail_View(coordinate_keys, detail_view_coordinate[coordinate_keys],\r\n#                                                drafting_up_Coordinate_Position[coordinate_keys][0],\r\n#                                                drafting_up_Coordinate_Position[coordinate_keys][1])\r\n#         else:\r\n#             draft.Define_Polygonal_Detail_View(coordinate_keys, detail_view_coordinate[coordinate_keys],\r\n#                                                drafting_down_Coordinate_Position[coordinate_keys][0],\r\n#                                                drafting_down_Coordinate_Position[coordinate_keys][1])\r\n#         mprog.switch_window()\r\n#         if coordinate_keys == 'Section view F-F':\r\n#             for name in par.part_name_Section_view_F_F:\r\n#                 mprog.hide_show_part(name, 0)\r\n#         elif coordinate_keys == 'Section view D-D':\r\n#             for name in par.part_name_Section_view_D_D:\r\n#                 mprog.hide_show_part(name, 0)\r\n#         mprog.switch_window()\r\n#     else:\r\n#         if coordinate_keys in drafting_up_Coordinate_Position:\r\n#             draft.Define_Polygonal_Detail_View(coordinate_keys, detail_view_coordinate[coordinate_keys],\r\n#                                                drafting_up_Coordinate_Position[coordinate_keys][0],\r\n#                                                drafting_up_Coordinate_Position[coordinate_keys][1])\r\n#         else:\r\n#             draft.Define_Polygonal_Detail_View(coordinate_keys, detail_view_coordinate[coordinate_keys],\r\n#                                                drafting_down_Coordinate_Position[coordinate_keys][0],\r\n#                                                drafting_down_Coordinate_Position[coordinate_keys][1])\r\n#\r\n# # 產生折斷線\r\n# # 注意:折斷線若為水平線，方框四角座標須以⌈水平⌋建立；折斷線若為垂直線，方框四角座標須以⌈垂直⌋建立\r\n# break_line_Coordinate = {'Section view E-E': [\r\n#     [float(0), float(par.A[i] / 6), float(par.B[i] / 3), float(par.A[i] / 6), float(0), float(-par.A[i] / 6),\r\n#      float(par.B[i] / 3), float(-par.A[i] / 6)], 0, 1]}\r\n# print(break_line_Coordinate['Section view E-E'][0][0:])\r\n# draft.break_line('Section view E-E', break_line_Coordinate['Section view E-E'][0],\r\n#                  break_line_Coordinate['Section view E-E'][1], break_line_Coordinate['Section view E-E'][2])\r\n#\r\n# # 關閉所有剖線線所產生之虛線\r\n# draft.close_all_Generated_Shape()\r\n#\r\n# # 產生防漏試驗之虛線\r\n# leakproof_broken_line = {\r\n#     'Front view': [[float(-par.A[i] / 2 + par.FRAME_6_7_width[i] + 50), float(0),\r\n#                     float(-par.A[i] / 2 + 50 + par.FRAME_6_7_width[i]), float(-par.S[i] / 2 - 200)], 0,\r\n#                    'Section view H-H']}\r\n# draft.Section('Front view', drafting_down_Coordinate_Position['Section view A-A'][0],\r\n#               drafting_down_Coordinate_Position['Section view A-A'][1], scale,\r\n#               leakproof_broken_line['Front view'][0], leakproof_broken_line['Front view'][1],\r\n#               leakproof_broken_line['Front view'][2])\r\n# Detail_view_leak_broken_line = [float(550), float(-552), float(550), float(-583), float(978), float(-583), float(978),\r\n#                                 float(-552)]\r\n# draft.Define_Polygonal_Cipping_View('Section view H-H', Detail_view_leak_broken_line)\r\ndraft.selection_Search_delete('Front view', \"Name='Callout (Section View).3', all\")\r\n\r\n# # 焊接符號生成\r\n# draft.symbol_of_weld('Front view', 3, -par.A[i] / 2 + 50 + 105, par.H[i] - par.S[i] - par.Z[i] - 32, 1)\r\n\r\n# # 圈碼圖生成\r\n# draft.balloons('Front view', '1', -par.A[i] / 2 - 100 * par.cos30, (par.H[i] - par.S[i] - par.Z[i]) * par.sin30 / 2, -par.A[i] / 2, (par.H[i] - par.S[i] - par.Z[i]) / 2, -par.A[i] / 2 - 100 * par.cos30)\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SYEI_stamping_press_system/TEST.py b/SYEI_stamping_press_system/TEST.py
--- a/SYEI_stamping_press_system/TEST.py	(revision 9b03e8114d34ddad78b2ae1878b096aad22932e2)
+++ b/SYEI_stamping_press_system/TEST.py	(date 1676267448552)
@@ -4,18 +4,18 @@
 import parameter as par
 
 i = 5
-# #
-# # mprog.switch_window()
-# #
-# # # 隱藏機架外零件
-# # for part_name in par.hide_part_name:
-# #     mprog.hide_show_part(part_name, 1)
+
+# mprog.switch_window()
+#
+# # 隱藏機架外零件
+# for part_name in par.hide_part_name:
+#     mprog.hide_show_part(part_name, 1)
 #
 # # 投影
-# # mprog.switch_window()
-drafting_down_Coordinate_Position, drafting_up_Coordinate_Position, scale = draft.drafting_welding_view_parameter_calculation(
-    par.A[i], par.B[i], par.H[i], par.S[i], par.Z[i], par.T[i])
-draft.change_Drawing_scale(1 / scale)
+# mprog.switch_window()
+# drafting_down_Coordinate_Position, drafting_up_Coordinate_Position, scale = draft.drafting_welding_view_parameter_calculation(
+#     par.A[i], par.B[i], par.H[i], par.S[i], par.Z[i], par.T[i])
+# draft.change_Drawing_scale(1 / scale)
 # # 副程式名稱須注意是否與立體圖相符
 # draft.Front_View_Drawing('SN1-110', drafting_down_Coordinate_Position['Right View'][0],
 #                          drafting_down_Coordinate_Position['Right View'][1], scale)  # 左側試圖
@@ -125,10 +125,10 @@
 # Detail_view_leak_broken_line = [float(550), float(-552), float(550), float(-583), float(978), float(-583), float(978),
 #                                 float(-552)]
 # draft.Define_Polygonal_Cipping_View('Section view H-H', Detail_view_leak_broken_line)
-draft.selection_Search_delete('Front view', "Name='Callout (Section View).3', all")
+# draft.selection_Search_delete('Front view', "Name='Callout (Section View).3', all")
 
-# # 焊接符號生成
-# draft.symbol_of_weld('Front view', 3, -par.A[i] / 2 + 50 + 105, par.H[i] - par.S[i] - par.Z[i] - 32, 1)
+# 焊接符號生成
+draft.symbol_of_weld('Front view', 3, -par.A[i] / 2 + 50 + 105, par.H[i] - par.S[i] - par.Z[i] - 32, 1, par.drafting_Welding_text['A-A Top'])
 
-# # 圈碼圖生成
-# draft.balloons('Front view', '1', -par.A[i] / 2 - 100 * par.cos30, (par.H[i] - par.S[i] - par.Z[i]) * par.sin30 / 2, -par.A[i] / 2, (par.H[i] - par.S[i] - par.Z[i]) / 2, -par.A[i] / 2 - 100 * par.cos30)
+# 圈碼圖生成
+draft.balloons('Front view', '1', -par.A[i] / 2 - 100 * par.cos30, (par.H[i] - par.S[i] - par.Z[i]) * par.sin30 / 2, -par.A[i] / 2, (par.H[i] - par.S[i] - par.Z[i]) / 2, -par.A[i] / 2 - 100 * par.cos30)
Index: SYEI_stamping_press_system/parameter.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import math\r\n\r\n# 電子型錄規格\r\nA = [720, 830, 890, 940, 1050, 1160, 1300, 1480, 1560, 1760]\r\nA_15 = [1080, 1245, 1335, 1410, 1575, 1740, 1950, 2220, 2340, 2640]\r\nB = [1058, 1125, 1210, 1315, 1480, 1680, 1985, 2113, 2400, 2700]\r\nB_15 = [1587, 1688, 1815, 1973, 2220, 2520, 2978, 3170, 3600, 4050]\r\nH = [2060, 2185, 2290, 2540, 2755, 2990, 3270, 3725, 4005, 4285]\r\nR = [388, 486, 516, 544, 614, 670, 730, 900, 970, 1040]\r\nR_15 = [582, 729, 774, 816, 921, 1005, 1095, 1350, 1455, 1560]\r\nE = [700, 780, 840, 900, 1050, 1150, 1250, 1400, 1500, 1600]\r\nE_15 = [1051, 1170, 1260, 1350, 1575, 1725, 1875, 2100, 2250, 2400]\r\nD_DH = [250, 280, 330, 350, 380, 430, 490, 550, 580, 610]\r\nD_S = [80, 90, 110, 130, 150, 180, 200, 220, 250, 280]\r\nD_H = [50, 60, 70, 80, 100, 110, 130, 150, 180, 210]\r\nD_P = [35, 40, 45, 50, 60, 70, 80, 90, 100, 110]\r\nDH_S = [230, 250, 270, 300, 330, 350, 400, 450, 450, 500]\r\nDH_H = [200, 220, 240, 270, 300, 320, 360, 400, 400, 450]\r\nDH_P = [200, 220, 240, 270, 300, 320, 360, 400, 400, 450]\r\nS = [983, 1068, 1158, 1285, 1445, 1630, 1809, 2067, 2262, 2357]\r\nH_Z = [1260, 1385, 1490, 1640, 1855, 2086.933, 2370, 2725, 3005, 3285]\r\nO = [1045, 1075, 1125, 1145, 1175, 1225, 1285, 1345, 1375, 1405]\r\nhole_type = [0, 1, 2]\r\nP = [330, 380, 430, 480, 560, 650, 720, 860, 960, 1060]\r\nP_15 = [495, 570, 645, 721, 840, 975, 1080, 1290, 1440, 1590]\r\nQ = [250, 300, 350, 400, 460, 520, 580, 650, 720, 790]\r\nQ_15 = [375, 450, 525, 600, 690, 780, 870, 975, 1080, 1185]\r\nT = [85, 100, 115, 130, 140, 155, 165, 180, 180, 200]\r\nZ = [800, 800, 800, 900, 900, 900, 900, 1000, 1000, 1100]\r\nF = [320, 400, 440, 520, 600, 680, 760, 840, 900, 960]\r\nFRAME20_H = [280, 355, 420, 437.5, 550, 680, 825, 990, 1120, 1170]\r\nFRAME2_lower_depth = [166.016, 246.016, 286.016, 366.016, 446.016, 526.016, 606.016, 686.016, 746.016, 806.016]\r\nFRAME2_lower_depth_15 = [331.016, 451.016, 511.016, 631.016, 751.016, 871.016, 991.016, 1111.016, 1201.016, 1291.016]\r\nFRAME1_lower_high = [1330, 1335, 1340, 1445, 1455, 1460, 1470, 1575, 1595, 1695]\r\nFRAME20_FRAME2_YZ = [805, 805, 979, 979, 979, 979, 979, 979, 979, 979]\r\nBALANCER1_XZ = [204, 253, 268, 282, 317, 345, 375, 460, 575, 690]  # (R+180mm)/2+80mm\r\nFRAME_10_H = [558, 620.5, 673, 798, 905.5, 1023, 1163, 1320.5, 1530.5, 1740.5]\r\nFRAME_32_XY = [0, 0, 0, 1722, 1819.5, 1922, 2052, 2294.5, 2504.5, 2794.5]\r\nFRAME44_height = [588 , 665.5 , 733 , 773 , 890.5 , 1023 , 1173 , 1385.5 , 1455.5 , 1445.5]\r\nFRAME_41_depth = [590 , 590 , 590 , 590 , 490 , 590 , 590 , 590 , 590 , 590]\r\nFRAME_7_width = [176 , 182 , 197 , 208 , 228 , 255 , 295 , 299 , 305 , 305]\r\nFRAME_7_15_width = [200.3 , 209.3 , 231.8 , 248.3 , 278.3 , 318.8 , 378.8 , 384.8 , 393.8 , 393.8]\r\nFRAME_11_height = [1122 , 1184.5 , 1237 , 1362 , 1469.5 , 1587 , 1727 , 1884.5 , 2094.5 , 2304.5]\r\nFRAME_11_width = [600 , 680 , 720 , 800 , 880 , 960 , 1040 , 1120 , 1180 , 1240]\r\nFRAME_11_15_width = [765 , 885 , 945 , 1065 , 1185 , 1305 , 1425 , 1545 , 1635 , 1725]\r\nFRAME_8_width = [164 , 170 , 185 , 196 , 216 , 243 , 283 , 288 , 293 , 358]\r\nFRAME_8_15_width = [246 , 255 , 278 , 294 , 324 , 365 , 425 , 432 , 440 , 537]\r\nFRAME_13_depth = [59.016 , 139.016 , 179.016 , 259.016 , 339.016 , 419.016 , 499.016 , 579.016 , 639.016 , 699.016]\r\nFRAME_6_7_width = [48.5, 54.5, 69.5, 80.5, 100.5, 127.5, 167.5, 171.5, 177.5]\r\npocket_1_upper_hole = [370 , 415 , 450 , 577.5 , 670 , 770 , 895 , 1080 , 1210 , 1340]\r\n# 三角函數\r\nsin45 = math.sin(math.radians(45))\r\ncos45 = math.cos(math.radians(45))\r\nsin30 = math.sin(math.radians(30))\r\ncos30 = math.cos(math.radians(30))\r\nsin60 = math.sin(math.radians(60))\r\ncos60 = math.cos(math.radians(60))\r\ncos35_267 = math.cos(math.radians(35.267))\r\nsin35_267 = math.sin(math.radians(35.267))\r\n\r\n# -------------焊接圖---------------\r\n#隱藏part\r\nhide_part_name = ['BOLSTER1', 'BOLSTER2', 'BOLSTER3', 'BALANCER_LEFT_All', 'BALANCER_RIGHT_All', 'CRANK_SHAFT_CLOCK',\r\n                  'CLUCTH_ASSEMBLY_All', 'SLIDE_UNIT_All', 'CRANK_SHAFT.1', 'JOINT_All', 'MAIN_GEAR1',\r\n                  'MAIN_GEAR3', 'MAIN_GEAR4', 'JOINT1', 'GIB1', 'GIB2', 'FRAME35', 'FRAME40', 'Fixture']\r\npart_name_Section_view_F_F = ['FRAME1', 'FRAME10']\r\npart_name_Section_view_D_D = ['FRAME21', 'FRAME22', 'FRAME32']\r\n# 前視圖中心 & 上視圖中心\r\ndrafting_front_area_centerX = 435\r\n# 下圖\r\ndrafting_down_area_centerY = 460 / 2 + 65\r\n# 上圖\r\ndrafting_up_area_centerY = (821 - 65 - 460) / 2 + 65 + 420\r\n# 圖面最大範圍框\r\ndrafting_view_min_Y = 43\r\ndrafting_view_max_Y = 842\r\ndrafting_view_min_X = 20\r\ndrafting_view_max_X = 1169\r\n# 圖框虛線間隔\r\ndraft_X_clearence = 10\r\ndraft_Y_clearence = 25\r\n# 下圖Y最小位置\r\ndrafting_down_min_Y = 65\r\n\r\n\r\n# 圈碼座標
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SYEI_stamping_press_system/parameter.py b/SYEI_stamping_press_system/parameter.py
--- a/SYEI_stamping_press_system/parameter.py	(revision 9b03e8114d34ddad78b2ae1878b096aad22932e2)
+++ b/SYEI_stamping_press_system/parameter.py	(date 1676258911165)
@@ -81,6 +81,7 @@
 draft_Y_clearence = 25
 # 下圖Y最小位置
 drafting_down_min_Y = 65
-
+# 焊接符號標註文字
+drafting_Welding_text = {'A-A Top': ['', ' ', 'QQ奶奶好喝到咩噗茶', '', '', '5']}
 
 # 圈碼座標
\ No newline at end of file
Index: SYEI_stamping_press_system/main_GUI.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from PyQt5 import QtCore, QtGui, QtWidgets\r\nimport sys, datetime, os, math\r\nfrom GUI import Ui_Dialog\r\nimport main_program as mprog\r\nimport drafting as draft\r\nimport drafting_part as dp\r\nimport drafting_part_calculate as dpc\r\nimport file_path as fp\r\nimport parameter as par\r\n\r\nchange = ()\r\nheight = ()\r\ntype = ()\r\nhole = ()\r\nclose = ()\r\n\r\nclass main(QtWidgets.QWidget, Ui_Dialog):\r\n    def __init__(self):\r\n        super(main, self).__init__()\r\n        self.ui = Ui_Dialog()\r\n        self.ui.setupUi(self)\r\n        self.ui.pushButton.clicked.connect(self.start)\r\n        self.add_item_for_comboBox()\r\n        self.path = str()\r\n        self.part_path = str()\r\n        BASE_DIR = os.path.dirname(os.path.realpath(__file__))\r\n        self.setWindowIcon(QtGui.QIcon(BASE_DIR + '\\\\ico.ico'))\r\n        self.a = int()\r\n        self.ui.comboBox_4.currentIndexChanged.connect(self.change_combobox4)\r\n\r\n    def insert_data_combobox_change(self):\r\n        data = {250: {230: [720, 1058], 200: [1080, 1587]},\r\n                350: {250: [830, 1125], 220: [1245, 1688]},\r\n                450: {270: [890, 1210], 240: [1335, 1815]},\r\n                600: {300: [940, 1315], 270: [1410, 1973]},\r\n                800: {330: [1050, 1480], 300: [1575, 2220]},\r\n                1100: {350: [1160, 1680], 320: [1740, 2520]},\r\n                1600: {400: [1300, 1985], 360: [1950, 2978]},\r\n                2000: {450: [1480, 2113], 400: [2220, 3170]},\r\n                2500: {450: [1560, 2400], 400: [2340, 3600]},\r\n                3000: {500: [1760, 2700], 450: [2640, 4050]}\r\n                }\r\n        return data\r\n\r\n    def change_combobox4(self):\r\n        print(self.ui.comboBox_4.currentText())\r\n        all_data = self.insert_data_combobox_change()\r\n        type = str(self.ui.comboBox_4.currentText())\r\n        ton = int(type.split('-')[-1] + '0')\r\n        close_h = list(all_data[ton].keys())\r\n        table_size = [str(all_data[ton][close_h[0]][0]) + 'x' + str(all_data[ton][close_h[0]][1]),\r\n                      str(all_data[ton][close_h[1]][0]) + 'x' + str(all_data[ton][close_h[1]][1])]\r\n        close_h = list(map(str, close_h))\r\n\r\n        self.ui.comboBox_2.clear()\r\n        self.ui.comboBox_2.addItems(table_size)\r\n        self.ui.comboBox_3.clear()\r\n        self.ui.comboBox_3.addItems(close_h)\r\n\r\n    def start(self):\r\n        l = str(self.ui.comboBox_2.currentText())\r\n        height = str(self.ui.comboBox_3.currentText())\r\n        type = str(self.ui.comboBox_4.currentText())\r\n        hole = str(self.ui.comboBox_5.currentText())\r\n        print(type, l, height, hole)\r\n        self.create_dir(type)\r\n        self.l, self.h, self.i, self.j = self.choos(l, height, type, hole)\r\n        self.change_dir(self.l, self.h, self.i, self.j, self.part_path)\r\n        self.ass_(self.l, self.h, self.i, self.j, self.path , self.part_path)\r\n\r\n    def choos(self, l, height, type, hole):\r\n        # 確認型號\"輸入型號\"\r\n        if type == \"SN1-25\" or type == \"sn1-25\" or type == \"25\":\r\n            i = 0\r\n        elif type == \"SN1-35\" or type == \"sn1-35\" or type == \"35\":\r\n            i = 1\r\n        elif type == \"SN1-45\" or type == \"sn1-45\" or type == \"45\":\r\n            i = 2\r\n        elif type == \"SN1-60\" or type == \"sn1-60\" or type == \"60\":\r\n            i = 3\r\n\r\n        elif type == \"SN1-80\" or type == \"sn1-80\" or type == \"80\":\r\n            i = 4\r\n        elif type == \"SN1-110\" or type == \"sn1-110\" or type == \"110\":\r\n            i = 5\r\n        elif type == \"SN1-160\" or type == \"sn1-160\" or type == \"160\":\r\n            i = 6\r\n        elif type == \"SN1-200\" or type == \"sn1-200\" or type == \"200\":\r\n            i = 7\r\n        elif type == \"SN1-250\" or type == \"sn1-250\" or type == \"250\":\r\n            i = 8\r\n        elif type == \"SN1-300\" or type == \"sn1-300\" or type == \"300\":\r\n            i = 9\r\n\r\n        # 合模高\r\n        if type == \"SN1-25\" and height == '230':\r\n            h = 0\r\n        elif type == \"SN1-25\" and height == '200':\r\n            h = 1\r\n        elif type == \"SN1-35\" and height == '250':\r\n            h = 0\r\n        elif type == \"SN1-35\" and height == '220':\r\n            h = 1\r\n        elif type == \"SN1-45\" and height == '270':\r\n            h = 0\r\n        elif type == \"SN1-45\" and height == '240':\r\n            h = 1\r\n        elif type == \"SN1-60\" and height == '300':\r\n            h = 0\r\n        elif type == \"SN1-60\" and height == '270':\r\n            h = 1\r\n        elif type == \"SN1-80\" and height == '330':\r\n            h = 0\r\n        elif type == \"SN1-80\" and height == '300':\r\n            h = 1\r\n        elif type == \"SN1-110\" and height == '350':\r\n            h = 0\r\n        elif type == \"SN1-110\" and height == '320':\r\n            h = 1\r\n        elif type == \"SN1-160\" and height == '400':\r\n            h = 0\r\n        elif type == \"SN1-160\" and height == '360':\r\n            h = 1\r\n        elif type == \"SN1-200\" and height == '450':\r\n            h = 0\r\n        elif type == \"SN1-200\" and height == '400':\r\n            h = 1\r\n        elif type == \"SN1-250\" and height == '450':\r\n            h = 0\r\n        elif type == \"SN1-250\" and height == '400':\r\n            h = 1\r\n        elif type == \"SN1-300\" and height == '500':\r\n            h = 0\r\n        elif type == \"SN1-300\" and height == '450':\r\n            h = 1\r\n\r\n        # 判斷長寬\r\n        if l == '720x1058' or l == '830x1125' or l == '890x1210' or l == '940x1315' or l == '1050x1480' or l == '1160x1680' or l == '1300x1985' or l == '1480x2113' or l == '1560x2400' or l == '1760x2700':\r\n            l = 1\r\n        elif l == '1080x1587' or l == '1245x1688' or l == '1335x1815' or l == '1410x1973' or l == '1575x2220' or l == '1740x2520' or l == '1950x2978' or l == '2220x3170' or l == '2340x3600' or l == '2640x4050':\r\n            l = 0\r\n\r\n        # 輸入平板型號\r\n        if hole == \"圓型平板\":\r\n            j = 0\r\n        elif hole == \"方型平板\":\r\n            j = 1\r\n        elif hole == \"模墊型平板\":\r\n            j = 2\r\n        return h, i, l, j\r\n\r\n    def add_item_for_comboBox(self):\r\n        print('insert')\r\n        # data = ['sd1', 'sd2']\r\n        # for item in data:\r\n        #     self.ui.comboBox.addItem(item)\r\n\r\n    def create_dir(self, type):  # 創建資料夾\r\n        time_now = datetime.datetime.now()\r\n        dir_name = '{}_{}_{}_{}_{}'.format(type, time_now.day, time_now.hour, time_now.minute, time_now.second)\r\n        desktop = os.path.join(os.path.join(os.environ['USERPROFILE']), 'Desktop')\r\n        path = desktop + '\\\\' + dir_name\r\n        os.mkdir(path)\r\n        part_path = path + \"\\\\\" + \"part\"\r\n        os.mkdir(part_path)\r\n        self.path = path\r\n        self.part_path = part_path\r\n\r\n    def change_dir(self, h, i, l, j, path):\r\n        # 開啟CATIA\r\n        env = mprog.set_CATIA_workbench_env()\r\n\r\n        # 匯入零件檔\r\n        file_name_list = ['BOLSTER1', 'BOLSTER2', 'BOLSTER3', 'Fixture', 'FRAME1', 'FRAME2', 'FRAME3', 'FRAME4',\r\n                          'FRAME5', 'FRAME6', 'FRAME7', 'FRAME8', 'FRAME9', 'FRAME10', 'FRAME11', 'FRAME12', 'FRAME13',\r\n                          'FRAME14', 'FRAME15', 'FRAME16', 'FRAME17', 'FRAME18', 'FRAME19', 'FRAME20', 'FRAME21',\r\n                          'FRAME22', 'FRAME23', 'FRAME24', 'FRAME25', 'FRAME26', 'FRAME27', 'FRAME28', 'FRAME29',\r\n                          'FRAME30', 'FRAME31', 'FRAME32', 'FRAME33', 'FRAME34', 'FRAME35', 'FRAME36', 'FRAME36',\r\n                          'FRAME37', 'FRAME38', 'FRAME39', 'FRAME40', 'FRAME41', 'FRAME42', 'FRAME43', 'FRAME44',\r\n                          'FRAME45', 'FRAME46', 'GIB1', 'GIB2', 'BALANCER_LEFT_All', 'BALANCER_RIGHT_ALL', 'CRANK_SHAFT_CLOCK',\r\n                          'CLUCTH_ASSEMBLY_All', 'SLIDE_UNIT_All', 'CRANK_SHAFT', 'JOINT_All', 'MAIN_GEAR1',\r\n                          'MAIN_GEAR2', 'MAIN_GEAR3', 'MAIN_GEAR4', 'JOINT1', 'FRAME47', 'FRAME48', 'FRAME49']\r\n\r\n        # 開啟零件檔更改變數後儲存並關閉\r\n        for name in file_name_list:\r\n            mprog.import_part(fp.system_root + fp.part, name)\r\n\r\n            if i == 4:\r\n                if name == 'SLIDE_UNIT_All':\r\n                    mprog.axis_system()\r\n                    mprog.scaling(0.8)\r\n                    if l == 0:\r\n                        mprog.param_change(name, 'P', par.P_15[i])\r\n                    else:\r\n                        mprog.param_change(name, 'P', par.P[i])\r\n                    mprog.save_file_part(path, name)\r\n                elif name == 'BALANCER_LEFT_All' or name == 'BALANCER_RIGHT_ALL':\r\n                    mprog.axis_system()\r\n                    mprog.scaling(0.7)\r\n                    mprog.save_file_part(path, name)\r\n                # elif name == 'GIB1' or name == 'GIB2':\r\n                #     mprog.axis_system()\r\n                #     mprog.scaling(0.9)\r\n                #     mprog.save_file_part(path, name)\r\n                else:\r\n                    if l == 0:\r\n                        if name == 'FRAME1' or name == 'FRAME2' or name == 'FRAME44' or name == 'GIB1' or name == 'GIB2':  # 更改零件變數B\r\n                            mprog.param_change(name, 'B', par.B_15[i])\r\n                            mprog.save_file_part(path, name)\r\n                        elif name == 'FRAME3' or name == 'FRAME4' or name == 'FRAME9' or name == 'FRAME32' or name == 'FRAME41' or name == 'FRAME43' or name == 'FRAME20' or name == 'FRAME30' or name == 'FRAME29' or name == 'FRAME42' or name == 'FRAME43' or name == 'FRAME45':  # 更改零件變數R\r\n                            mprog.param_change(name, 'R', par.R_15[i])\r\n                            mprog.save_file_part(path, name)\r\n                        elif name == 'FRAME10' or name == 'FRAME11' or name == 'FRAME12' or name == 'FRAME13' or name == 'BOLSTER1':  # 更改零件變數E\r\n                            mprog.param_change(name, 'E', par.E_15[i])\r\n                            if name == 'BOLSTER1':\r\n                                mprog.param_change('BOLSTER1', \"hole_type\", par.hole_type[j])\r\n                            mprog.save_file_part(path, name)\r\n                        elif name == 'FRAME29' or name == 'FRAME8' or name == 'FRAME5' or name == 'FRAME6' or name == 'FRAME7':  # 更改零件變數A\r\n                            mprog.param_change(name, 'A', par.A_15[i])\r\n                            mprog.save_file_part(path, name)\r\n                        elif name == 'SLIDE_UNIT_All':  # 更改零件變數P\r\n                            mprog.param_change(name, 'P', par.P_15[i])\r\n                            mprog.save_file_part(path, name)\r\n                        elif name == 'BOLSTER3' or name == 'BOLSTER2':  # 更改零件變數Q\r\n                            mprog.param_change(name, 'Q', par.Q_15[i])\r\n                            mprog.save_file_part(path, name)\r\n                        else:\r\n                            mprog.save_file_part(path, name)\r\n                    else:\r\n                        if name == 'FRAME1' or name == 'FRAME2' or name == 'FRAME44' or name == 'GIB1' or name == 'GIB2':  # 更改零件變數B\r\n                            mprog.param_change(name, 'B', par.B[i])\r\n                            mprog.save_file_part(path, name)\r\n                        elif name == 'FRAME3' or name == 'FRAME4' or name == 'FRAME9' or name == 'FRAME32' or name == 'FRAME41' or name == 'FRAME43' or name == 'FRAME20' or name == 'FRAME30' or name == 'FRAME29' or name == 'FRAME42' or name == 'FRAME42' or name == 'FRAME43' or name == 'FRAME45':  # 更改零件變數R\r\n                            mprog.param_change(name, 'R', par.R[i])\r\n                            mprog.save_file_part(path, name)\r\n                        elif name == 'FRAME10' or name == 'FRAME11' or name == 'FRAME12' or name == 'FRAME13' or name == 'BOLSTER1':  # 更改零件變數E\r\n                            mprog.param_change(name, 'E', par.E[i])\r\n                            if name == 'BOLSTER1':\r\n                                mprog.param_change('BOLSTER1', \"hole_type\", par.hole_type[j])\r\n                            mprog.save_file_part(path, name)\r\n                        elif name == 'FRAME29' or name == 'FRAME8' or name == 'FRAME5' or name == 'FRAME6' or name == 'FRAME7':  # 更改零件變數A\r\n                            mprog.param_change(name, 'A', par.A[i])\r\n                            mprog.save_file_part(path, name)\r\n                        elif name == 'SLIDE_UNIT_All':  # 更改零件變數P\r\n                            mprog.param_change(name, 'P', par.P[i])\r\n                            mprog.save_file_part(path, name)\r\n                        elif name == 'BOLSTER3' or name == 'BOLSTER2':  # 更改零件變數Q\r\n                            mprog.param_change(name, 'Q', par.Q[i])\r\n                            mprog.save_file_part(path, name)\r\n                        else:\r\n                            mprog.save_file_part(path, name)\r\n            else:\r\n                if l == 0:\r\n                    if name == 'FRAME1' or name == 'FRAME2' or name == 'FRAME44' or name == 'GIB1' or name == 'GIB2':  # 更改零件變數B\r\n                        mprog.param_change(name, 'B', par.B_15[i])\r\n                        mprog.save_file_part(path, name)\r\n                    elif name == 'FRAME3' or name == 'FRAME4' or name == 'FRAME9' or name == 'FRAME32' or name == 'FRAME41' or name == 'FRAME43' or name == 'FRAME20' or name == 'FRAME30' or name == 'FRAME29' or name == 'FRAME42' or name == 'FRAME42' or name == 'FRAME43' or name == 'FRAME45':  # 更改零件變數R\r\n                        mprog.param_change(name, 'R', par.R_15[i])\r\n                        mprog.save_file_part(path, name)\r\n                    elif name == 'FRAME10' or name == 'FRAME11' or name == 'FRAME12' or name == 'FRAME13' or name == 'BOLSTER1':  # 更改零件變數E\r\n                        mprog.param_change(name, 'E', par.E_15[i])\r\n                        if name == 'BOLSTER1':\r\n                            mprog.param_change('BOLSTER1', \"hole_type\", par.hole_type[j])\r\n                        mprog.save_file_part(path, name)\r\n                    elif name == 'FRAME29' or name == 'FRAME8' or name == 'FRAME5' or name == 'FRAME6' or name == 'FRAME7':  # 更改零件變數A\r\n                        mprog.param_change(name, 'A', par.A_15[i])\r\n                        mprog.save_file_part(path, name)\r\n                    elif name == 'SLIDE_UNIT_All':  # 更改零件變數P\r\n                        mprog.param_change(name, 'P', par.P_15[i])\r\n                        mprog.save_file_part(path, name)\r\n                    elif name == 'BOLSTER3' or name == 'BOLSTER2':  # 更改零件變數Q\r\n                        mprog.param_change(name, 'Q', par.Q_15[i])\r\n                        mprog.save_file_part(path, name)\r\n                    else:\r\n                        mprog.save_file_part(path, name)\r\n                else:\r\n                    if name == 'FRAME1' or name == 'FRAME2' or name == 'FRAME44' or name == 'GIB1' or name == 'GIB2':  # 更改零件變數B\r\n                        mprog.param_change(name, 'B', par.B[i])\r\n                        mprog.save_file_part(path, name)\r\n                    elif name == 'FRAME3' or name == 'FRAME4' or name == 'FRAME9' or name == 'FRAME32' or name == 'FRAME41' or name == 'FRAME43' or name == 'FRAME20' or name == 'FRAME30' or name == 'FRAME29' or name == 'FRAME42' or name == 'FRAME42' or name == 'FRAME43' or name == 'FRAME45':  # 更改零件變數R\r\n                        mprog.param_change(name, 'R', par.R[i])\r\n                        mprog.save_file_part(path, name)\r\n                    elif name == 'FRAME10' or name == 'FRAME11' or name == 'FRAME12' or name == 'FRAME13' or name == 'BOLSTER1':  # 更改零件變數E\r\n                        mprog.param_change(name, 'E', par.E[i])\r\n                        if name == 'BOLSTER1':\r\n                            mprog.param_change('BOLSTER1', \"hole_type\", par.hole_type[j])\r\n                        mprog.save_file_part(path, name)\r\n                    elif name == 'FRAME29' or name == 'FRAME8' or name == 'FRAME5' or name == 'FRAME6' or name == 'FRAME7':  # 更改零件變數A\r\n                        mprog.param_change(name, 'A', par.A[i])\r\n                        mprog.save_file_part(path, name)\r\n                    elif name == 'SLIDE_UNIT_All':  # 更改零件變數P\r\n                        mprog.param_change(name, 'P', par.P[i])\r\n                        mprog.save_file_part(path, name)\r\n                    elif name == 'BOLSTER3' or name == 'BOLSTER2':  # 更改零件變數Q\r\n                        mprog.param_change(name, 'Q', par.Q[i])\r\n                        mprog.save_file_part(path, name)\r\n                    else:\r\n                        mprog.save_file_part(path, name)\r\n\r\n    def ass_(self, h, i, l, j, path , part_path):\r\n        type = str(self.ui.comboBox_4.currentText())  # 沖床噸數類型\r\n        # 開啟新組合檔\r\n        mprog.assembly_create()\r\n\r\n        # 匯入待組合零件檔\r\n        file_Assembly_name_list = ['BOLSTER1', 'BOLSTER2', 'BOLSTER3', 'Fixture', 'FRAME1', 'FRAME2', 'FRAME3',\r\n                                   'FRAME4', 'FRAME5', 'FRAME6', 'FRAME7', 'FRAME8', 'FRAME9', 'FRAME10', 'FRAME11',\r\n                                   'FRAME12', 'FRAME13', 'FRAME14', 'FRAME15', 'FRAME16', 'FRAME17', 'FRAME18',\r\n                                   'FRAME19', 'FRAME20', 'FRAME21', 'FRAME22', 'FRAME23', 'FRAME24', 'FRAME25',\r\n                                   'FRAME26', 'FRAME27', 'FRAME28', 'FRAME29', 'FRAME30', 'FRAME31', 'FRAME31',\r\n                                   'FRAME31', 'FRAME31', 'FRAME32', 'FRAME33', 'FRAME34', 'FRAME34', 'FRAME35',\r\n                                   'FRAME36', 'FRAME36', 'FRAME37', 'FRAME37', 'FRAME37', 'FRAME37', 'FRAME38',\r\n                                   'FRAME39', 'FRAME40', 'FRAME41', 'FRAME42', 'FRAME43', 'FRAME44', 'FRAME45',\r\n                                   'FRAME46', 'FRAME47', 'FRAME47', 'FRAME48', 'FRAME49', 'GIB1', 'GIB2',\r\n                                   'BALANCER_LEFT_All', 'BALANCER_RIGHT_ALL', 'CRANK_SHAFT_CLOCK', 'CLUCTH_ASSEMBLY_All',\r\n                                   'SLIDE_UNIT_ALL', 'CRANK_SHAFT', 'JOINT_All', 'MAIN_GEAR1', 'MAIN_GEAR2', 'MAIN_GEAR3',\r\n                                   'MAIN_GEAR4', 'JOINT1']\r\n\r\n        for x in file_Assembly_name_list:  # 讀取串列名稱並匯入檔案\r\n            mprog.import_file_Part(part_path, x)\r\n\r\n        mprog.base_lock('FRAME20.1', 'FRAME20.1', 0)  # 基準零件(定海神針)\r\n\r\n        # (0表示SAME, 1表示OPPOSITE)\r\n        # 平板-四底座\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME6.1', par.A_15[i] / 2, 'XZ.PLANE', 1, 1)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME6.1', par.A[i] / 2, 'XZ.PLANE', 1, 1)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME6.1', -par.Z[i], 'XY.PLANE', 1, 2)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME6.1', -80 - par.B_15[i] + par.F[i] / 2, 'YZ.PLANE', 1, 3)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME6.1', -80 - par.B[i] + par.F[i] / 2, 'YZ.PLANE', 1, 3)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME7.1', -par.A_15[i] / 2, 'XZ.PLANE', 0, 4)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME7.1', -par.A[i] / 2, 'XZ.PLANE', 0, 4)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME7.1', -par.Z[i], 'XY.PLANE', 0, 5)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME7.1', -80 - par.B_15[i] + par.F[i] / 2, 'YZ.PLANE', 1, 6)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME7.1', -80 - par.B[i] + par.F[i] / 2, 'YZ.PLANE', 1, 6)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME5.1', -par.A_15[i] / 2, 'XZ.PLANE', 0, 7)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME5.1', -par.A[i] / 2, 'XZ.PLANE', 0, 7)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME5.1', -par.Z[i], 'XY.PLANE', 1, 8)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME7.1', 'FRAME5.1', -par.B_15[i], 'YZ.PLANE', 1, 9)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME7.1', 'FRAME5.1', -par.B[i], 'YZ.PLANE', 1, 9)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME8.1', par.A_15[i] / 2, 'XZ.PLANE', 0, 10)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME8.1', par.A[i] / 2, 'XZ.PLANE', 0, 10)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME8.1', -par.Z[i], 'XY.PLANE', 0, 11)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME6.1', 'FRAME8.1', -par.B_15[i], 'YZ.PLANE', 0, 12)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME6.1', 'FRAME8.1', -par.B[i], 'YZ.PLANE', 0, 12)\r\n        # 左右側板\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME2.1', par.R_15[i] / 2 + 140, 'XZ.PLANE', 1, 13)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME2.1', par.R[i] / 2 + 140, 'XZ.PLANE', 1, 13)\r\n        mprog.add_offset_assembly('FRAME8.1', 'FRAME2.1', par.H[i] / 2, 'XY.PLANE', 0, 14)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME8.1', 'FRAME2.1', par.B_15[i] / 2, 'YZ.PLANE', 0, 15)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME8.1', 'FRAME2.1', par.B[i] / 2, 'YZ.PLANE', 0, 15)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME1.1', -par.R_15[i] / 2 - 140, 'XZ.PLANE', 1, 16)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME1.1', -par.R[i] / 2 - 140, 'XZ.PLANE', 1, 16)\r\n        mprog.add_offset_assembly('FRAME5.1', 'FRAME1.1', -par.H[i] / 2, 'XY.PLANE', 1, 17)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME5.1', 'FRAME1.1', -par.B_15[i] / 2, 'YZ.PLANE', 1, 18)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME5.1', 'FRAME1.1', -par.B[i] / 2, 'YZ.PLANE', 1, 18)\r\n        # 底部前、中板\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME5.1', 'FRAME3.1', par.A_15[i] / 2, 'XZ.PLANE', 1, 19)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME5.1', 'FRAME3.1', par.A[i] / 2, 'XZ.PLANE', 1, 19)\r\n        mprog.add_offset_assembly('FRAME5.1', 'FRAME3.1', 0, 'XY.PLANE', 0, 20)\r\n        mprog.add_offset_assembly('FRAME5.1', 'FRAME3.1', 0, 'YZ.PLANE', 1, 21)\r\n        mprog.add_offset_assembly('FRAME9.1', 'FRAME3.1', 0, 'XZ.PLANE', 0, 22)\r\n        mprog.add_offset_assembly('FRAME9.1', 'FRAME3.1', 0, 'XY.PLANE', 0, 23)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME9.1', 'FRAME3.1', -par.FRAME2_lower_depth_15[i] + 5, 'YZ.PLANE', 0, 24)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME9.1', 'FRAME3.1', -par.FRAME2_lower_depth[i] + 5, 'YZ.PLANE', 0, 24)\r\n        # 中間左右側板\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME11.1', 'FRAME3.1', par.R_15[i] / 2, 'XZ.PLANE', 0, 25)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME11.1', 'FRAME3.1', par.R[i] / 2, 'XZ.PLANE', 0, 25)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME11.1', -par.T[i], 'XY.PLANE', 1, 26)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME3.1', 'FRAME11.1', par.FRAME2_lower_depth_15[i], 'YZ.PLANE', 1, 27)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME3.1', 'FRAME11.1', par.FRAME2_lower_depth[i], 'YZ.PLANE', 1, 27)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME10.1', -par.R_15[i] / 2 - 90, 'XZ.PLANE', 0, 28)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME10.1', -par.R[i] / 2 - 90, 'XZ.PLANE', 0, 28)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME10.1', -par.T[i], 'XY.PLANE', 0, 29)\r\n        if l == 0:\r\n            if i == 4:\r\n                mprog.add_offset_assembly('FRAME3.1', 'FRAME10.1', par.FRAME2_lower_depth_15[i] + 80, 'YZ.PLANE', 1, 30)\r\n            else:\r\n                mprog.add_offset_assembly('FRAME3.1', 'FRAME10.1', par.FRAME2_lower_depth_15[i], 'YZ.PLANE', 1, 30)\r\n        else:\r\n            if i == 4:\r\n                mprog.add_offset_assembly('FRAME3.1', 'FRAME10.1', par.FRAME2_lower_depth[i] + 80, 'YZ.PLANE', 1, 30)\r\n            else:\r\n                mprog.add_offset_assembly('FRAME3.1', 'FRAME10.1', par.FRAME2_lower_depth[i], 'YZ.PLANE', 1, 30)\r\n        # 底部後面ㄇ形角鐵\r\n        mprog.add_offset_assembly('FRAME3.1', 'FRAME4.1', 0, 'XZ.PLANE', 1, 31)\r\n        mprog.add_offset_assembly('FRAME3.1', 'FRAME4.1', 0, 'XY.PLANE', 0, 32)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME3.1', 'FRAME4.1', par.B_15[i], 'YZ.PLANE', 0, 33)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME3.1', 'FRAME4.1', par.B[i], 'YZ.PLANE', 0, 33)\r\n        # 平板底部零件\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME12.1', -par.R_15[i] / 2, 'XZ.PLANE', 1, 34)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME12.1', -par.R[i] / 2, 'XZ.PLANE', 1, 34)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME12.1', -par.T[i], 'XY.PLANE', 0, 35)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME12.1', 0, 'YZ.PLANE', 1, 36)\r\n        # 平板底部零件\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME13.1', par.R_15[i] / 2, 'XZ.PLANE', 1, 37)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME13.1', par.R[i] / 2, 'XZ.PLANE', 1, 37)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME13.1', -par.T[i], 'XY.PLANE', 0, 38)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME13.1', 0, 'YZ.PLANE', 1, 39)\r\n        # 前中上軸承板&角鐵\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME20.1', 0, 'XZ.PLANE', 1, 40)\r\n        mprog.add_offset_assembly('FRAME3.1', 'FRAME20.1', -par.H[i] + 40, 'XY.PLANE', 0, 41)\r\n        mprog.add_offset_assembly('FRAME3.1', 'FRAME20.1', 0, 'YZ.PLANE', 0, 42)\r\n        mprog.add_offset_assembly('FRAME30.1', 'FRAME20.1', 0, 'XZ.PLANE', 0, 43)\r\n        mprog.add_offset_assembly('FRAME30.1', 'FRAME20.1', -5, 'XY.PLANE', 0, 44)\r\n        mprog.add_offset_assembly('FRAME30.1', 'FRAME20.1', -550, 'YZ.PLANE', 0, 45)\r\n        mprog.add_offset_assembly('FRAME29.1', 'FRAME20.1', 0, 'XZ.PLANE', 1, 46)\r\n        mprog.add_offset_assembly('FRAME29.1', 'FRAME20.1', -par.FRAME20_H[i], 'XY.PLANE', 0, 47)\r\n        mprog.add_offset_assembly('FRAME29.1', 'FRAME20.1', 0, 'YZ.PLANE', 1, 48)\r\n        # 氣壓缸鎖固板左右\r\n        if i == 4:\r\n            mprog.add_offset_assembly('FRAME2.1', 'FRAME21.1', 183, 'XZ.PLANE', 1, 49)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME2.1', 'FRAME21.1', 242, 'XZ.PLANE', 1, 49)\r\n        mprog.add_offset_assembly('FRAME3.1', 'FRAME21.1', -par.H[i] + 40, 'XY.PLANE', 1, 50)\r\n        mprog.add_offset_assembly('FRAME20.1', 'FRAME21.1', 280, 'YZ.PLANE', 1, 51)\r\n        if i == 4:\r\n            mprog.add_offset_assembly('FRAME1.1', 'FRAME22.1', -183, 'XZ.PLANE', 1, 52)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME1.1', 'FRAME22.1', -242, 'XZ.PLANE', 1, 52)\r\n        mprog.add_offset_assembly('FRAME3.1', 'FRAME22.1', -par.H[i] + 40, 'XY.PLANE', 0, 53)\r\n        mprog.add_offset_assembly('FRAME20.1', 'FRAME22.1', 280, 'YZ.PLANE', 1, 54)\r\n        # 鎖固平板六兄弟\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME14.1', 0, 'XZ.PLANE', 0, 55)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME14.1', -par.T[i], 'XY.PLANE', 0, 56)\r\n        mprog.add_offset_assembly('FRAME3.1', 'FRAME14.1', -75, 'YZ.PLANE', 1, 57)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME15.1', par.R_15[i] / 2 + 75 + 140, 'XZ.PLANE', 0, 58)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME15.1', par.R[i] / 2 + 75 + 140, 'XZ.PLANE', 0, 58)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME15.1', -par.T[i], 'XY.PLANE', 0, 59)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME15.1', -par.F[i] / 2 + 80 + 37.5, 'YZ.PLANE', 1, 60)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME16.1', par.R_15[i] / 2 + 75 + 140, 'XZ.PLANE', 0, 61)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME16.1', par.R[i] / 2 + 75 + 140, 'XZ.PLANE', 0, 61)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME16.1', -par.T[i], 'XY.PLANE', 0, 62)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME16.1', par.F[i] / 2 - 80 - 37.5, 'YZ.PLANE', 1, 63)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME18.1', -par.R_15[i] / 2 - 75 - 140, 'XZ.PLANE', 1, 64)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME18.1', -par.R[i] / 2 - 75 - 140, 'XZ.PLANE', 1, 64)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME18.1', -par.T[i], 'XY.PLANE', 0, 65)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME18.1', par.F[i] / 2 - 80 - 37.5, 'YZ.PLANE', 0, 66)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME19.1', -par.R_15[i] / 2 - 75 - 140, 'XZ.PLANE', 1, 67)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'FRAME19.1', -par.R[i] / 2 - 75 - 140, 'XZ.PLANE', 1, 67)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME19.1', -par.T[i], 'XY.PLANE', 0, 68)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME19.1', -par.F[i] / 2 + 80 + 37.5, 'YZ.PLANE', 0, 69)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME17.1', 0, 'XZ.PLANE', 1, 70)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'FRAME17.1', -par.T[i], 'XY.PLANE', 0, 71)\r\n        mprog.add_offset_assembly('FRAME9.1', 'FRAME17.1', 0, 'YZ.PLANE', 0, 72)\r\n        # 左右側板前GIB\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME3.1', par.FRAME1_lower_high[i] + 40 - 34.5, 'XY.PLANE', 0, 73)\r\n        else:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME3.1', par.FRAME1_lower_high[i] + 40, 'XY.PLANE', 0, 73)\r\n        mprog.add_offset_assembly('GIB1.1', 'FRAME1.1', 72.5, 'XZ.PLANE', 0, 74)\r\n        mprog.add_offset_assembly('GIB1.1', 'FRAME5.1', 334.65, 'YZ.PLANE', 0, 75)\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME3.1', par.FRAME1_lower_high[i] + 40 - 34.5, 'XY.PLANE', 0, 76)\r\n        else:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME3.1', par.FRAME1_lower_high[i] + 40, 'XY.PLANE', 0, 76)\r\n        mprog.add_offset_assembly('GIB2.1', 'FRAME2.1', -72.5, 'XZ.PLANE', 0, 77)\r\n        mprog.add_offset_assembly('GIB2.1', 'FRAME5.1', 334.65, 'YZ.PLANE', 0, 78)\r\n        # 左GIB後鎖固用方塊\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME23.1', -par.pocket_1_upper_hole[i] + 80 + 3, 'XY.PLANE', 1, 79)\r\n        else:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME23.1', -par.pocket_1_upper_hole[i] + 80 + 3, 'XY.PLANE', 1, 79)\r\n        mprog.add_offset_assembly('FRAME2.1', 'FRAME23.1', 50 + 35, 'XZ.PLANE', 1, 80)\r\n        mprog.add_offset_assembly('GIB2.1', 'FRAME23.1', 0, 'YZ.PLANE', 0, 81)\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME24.1', -34.5, 'XY.PLANE', 1, 82)\r\n        else:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME24.1', 0, 'XY.PLANE', 1, 82)\r\n        mprog.add_offset_assembly('FRAME2.1', 'FRAME24.1', 50 + 35, 'XZ.PLANE', 0, 83)\r\n        mprog.add_offset_assembly('GIB2.1', 'FRAME24.1', 0, 'YZ.PLANE', 1, 84)\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME27.1', -par.pocket_1_upper_hole[i] + 340 + 80, 'XY.PLANE', 1, 85)\r\n        else:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME27.1', -par.pocket_1_upper_hole[i] + 340 + 80, 'XY.PLANE', 1, 85)\r\n        mprog.add_offset_assembly('FRAME2.1', 'FRAME27.1', 50, 'XZ.PLANE', 1, 86)\r\n        mprog.add_offset_assembly('GIB2.1', 'FRAME27.1', 0, 'YZ.PLANE', 1, 87)\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME31.1', -par.pocket_1_upper_hole[i], 'XY.PLANE', 1, 88)\r\n        else:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME31.1', -par.pocket_1_upper_hole[i], 'XY.PLANE', 1, 88)\r\n        mprog.add_offset_assembly('FRAME23.1', 'FRAME31.1', -35, 'XZ.PLANE', 0, 89)\r\n        mprog.add_offset_assembly('FRAME23.1', 'FRAME31.1', -130.35 - 22.5, 'YZ.PLANE', 0, 90)\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME31.2', -150 - 34.5, 'XY.PLANE', 1, 91)\r\n        else:\r\n            mprog.add_offset_assembly('GIB2.1', 'FRAME31.2', -150, 'XY.PLANE', 1, 91)\r\n        mprog.add_offset_assembly('FRAME23.1', 'FRAME31.2', -130.35 - 22.5, 'YZ.PLANE', 0, 92)\r\n        mprog.add_offset_assembly('FRAME23.1', 'FRAME31.2', -35, 'XZ.PLANE', 0, 93)\r\n        # 右GIB後鎖固用方塊\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME25.1', -par.pocket_1_upper_hole[i] + 80 + 3, 'XY.PLANE', 1, 94)\r\n        else:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME25.1', -par.pocket_1_upper_hole[i] + 80 + 3, 'XY.PLANE', 1, 94)\r\n        mprog.add_offset_assembly('FRAME1.1', 'FRAME25.1', -50 - 35, 'XZ.PLANE', 0, 95)\r\n        mprog.add_offset_assembly('GIB1.1', 'FRAME25.1', 0, 'YZ.PLANE', 1, 96)\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME26.1', -34.5, 'XY.PLANE', 1, 97)\r\n        else:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME26.1', 0, 'XY.PLANE', 1, 97)\r\n        mprog.add_offset_assembly('FRAME1.1', 'FRAME26.1', -50 - 35, 'XZ.PLANE', 0, 98)\r\n        mprog.add_offset_assembly('GIB1.1', 'FRAME26.1', 0, 'YZ.PLANE', 0, 99)\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME28.1', -par.pocket_1_upper_hole[i] + 340 + 80, 'XY.PLANE', 1, 100)\r\n        else:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME28.1', -par.pocket_1_upper_hole[i] + 340 + 80, 'XY.PLANE', 1, 100)\r\n        mprog.add_offset_assembly('FRAME1.1', 'FRAME28.1', -50, 'XZ.PLANE', 0, 101)\r\n        mprog.add_offset_assembly('GIB1.1', 'FRAME28.1', 0, 'YZ.PLANE', 1, 102)\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME31.3', par.pocket_1_upper_hole[i], 'XY.PLANE', 1, 103)\r\n        else:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME31.3', par.pocket_1_upper_hole[i], 'XY.PLANE', 1, 103)\r\n        mprog.add_offset_assembly('FRAME25.1', 'FRAME31.3', -35, 'XZ.PLANE', 1, 104)\r\n        mprog.add_offset_assembly('FRAME25.1', 'FRAME31.3', 130.35 + 22.5, 'YZ.PLANE', 1, 105)\r\n        if i == 4:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME31.4', -150 - 34.5, 'XY.PLANE', 1, 106)\r\n        else:\r\n            mprog.add_offset_assembly('GIB1.1', 'FRAME31.4', -150, 'XY.PLANE', 1, 106)\r\n        mprog.add_offset_assembly('FRAME31.3', 'FRAME31.4', 0, 'YZ.PLANE', 0, 107)\r\n        mprog.add_offset_assembly('FRAME31.3', 'FRAME31.4', 0, 'XZ.PLANE', 0, 108)\r\n        # 中間與平板鎖固方塊下板子\r\n        mprog.add_offset_assembly('FRAME43.1', 'FRAME17.1', -48, 'XY.PLANE', 1, 109)\r\n        mprog.add_offset_assembly('FRAME43.1', 'FRAME17.1', 0, 'XZ.PLANE', 0, 110)\r\n        mprog.add_offset_assembly('FRAME43.1', 'FRAME17.1', 0, 'YZ.PLANE', 1, 111)\r\n        # 後面安裝馬達下板子\r\n        mprog.add_offset_assembly('FRAME41.1', 'FRAME20.1', -1340, 'XY.PLANE', 0, 112)\r\n        mprog.add_offset_assembly('FRAME41.1', 'FRAME4.1', 0, 'XZ.PLANE', 0, 113)\r\n        mprog.add_offset_assembly('FRAME41.1', 'FRAME4.1', 0, 'YZ.PLANE', 0, 114)\r\n        # FRAME2中間下板子\r\n        mprog.add_offset_assembly('FRAME32.1', 'BOLSTER1.1', 0, 'XZ.PLANE', 0, 115)\r\n        mprog.add_offset_assembly('FRAME32.1', 'FRAME3.1', par.FRAME_32_XY[i] + 20, 'XY.PLANE', 0, 116)\r\n        mprog.add_offset_assembly('FRAME32.1', 'FRAME30.1', 0, 'YZ.PLANE', 0, 117)\r\n        # 後方大軸承支架\r\n        mprog.add_offset_assembly('FRAME10.1', 'FRAME34.2', -485.543, 'YZ.PLANE', 1, 118)\r\n        mprog.add_offset_assembly('FRAME34.2', 'FRAME10.1', -(par.FRAME_10_H[i] + 40), 'XY.PLANE', 0, 119)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME34.2', 'FRAME3.1', -par.R_15[i] / 2 - 90, 'XZ.PLANE', 0, 120)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME34.2', 'FRAME3.1', -par.R[i] / 2 - 90, 'XZ.PLANE', 0, 120)\r\n        if l == 0:\r\n            mprog.add_offset_assembly('FRAME34.1', 'FRAME34.2', -par.R_15[i] - 180, 'XZ.PLANE', 1, 121)\r\n        else:\r\n            mprog.add_offset_assembly('FRAME34.1', 'FRAME34.2', -par.R[i] - 180, 'XZ.PLANE', 1, 121)\r\n        mprog.add_offset_assembly('FRAME34.1', 'FRAME34.2', 0, 'XY.PLANE', 1, 122)\r\n        mprog.add_offset_assembly('FRAME34.1', 'FRAME34.2', 0, 'YZ.PLANE', 0, 123)\r\n        # 後方大軸承\r\n        mprog.add_offset_assembly('FRAME35.1', 'FRAME3.1', 0, 'XZ.PLANE', 1, 124)\r\n        mprog.add_offset_assembly('FRAME35.1', 'FRAME20.1', -(par.H[i] - par.Z[i] - par.S[i] - 34 + 448), 'XY.PLANE', 0, 125)\r\n        mprog.add_offset_assembly('FRAME35.1', 'FRAME20.1', -par.FRAME20_FRAME2_YZ[i] - 36, 'YZ.PLANE', 0, 126)\r\n        # 後方馬達下支撐板\r\n        mprog.add_offset_assembly('FRAME39.1', 'FRAME1.1', 50, 'XZ.PLANE', 0, 127)\r\n        mprog.add_offset_assembly('FRAME39.1', 'FRAME20.1', -360, 'XY.PLANE', 0, 128)\r\n        mprog.add_offset_assembly('FRAME39.1', 'FRAME7.1', 320, 'YZ.PLANE', 0, 129)\r\n        mprog.add_offset_assembly('FRAME38.1', 'FRAME2.1', -50, 'XZ.PLANE', 0, 130)\r\n        mprog.add_offset_assembly('FRAME38.1', 'FRAME20.1', 360, 'XY.PLANE', 1, 131)\r\n        mprog.add_offset_assembly('FRAME38.1', 'FRAME6.1', -320, 'YZ.PLANE', 1, 132)\r\n        mprog.add_offset_assembly('FRAME37.1', 'FRAME39.1', 0, 'XZ.PLANE', 0, 133)\r\n        mprog.add_offset_assembly('FRAME37.1', 'FRAME39.1', 19, 'XY.PLANE', 1, 134)\r\n        mprog.add_offset_assembly('FRAME37.1', 'FRAME39.1', 125, 'YZ.PLANE', 1, 135)\r\n        mprog.add_offset_assembly('FRAME37.2', 'FRAME39.1', 0, 'XZ.PLANE', 0, 136)\r\n        mprog.add_offset_assembly('FRAME37.2', 'FRAME39.1', 19, 'XY.PLANE', 1, 137)\r\n        mprog.add_offset_assembly('FRAME37.2', 'FRAME39.1', -125, 'YZ.PLANE', 1, 138)\r\n        mprog.add_offset_assembly('FRAME37.3', 'FRAME38.1', 0, 'XZ.PLANE', 1, 139)\r\n        mprog.add_offset_assembly('FRAME37.3', 'FRAME38.1', 0, 'XY.PLANE', 0, 140)\r\n        mprog.add_offset_assembly('FRAME37.3', 'FRAME38.1', -125, 'YZ.PLANE', 1, 141)\r\n        mprog.add_offset_assembly('FRAME37.4', 'FRAME38.1', 0, 'XZ.PLANE', 1, 142)\r\n        mprog.add_offset_assembly('FRAME37.4', 'FRAME38.1', 0, 'XY.PLANE', 0, 143)\r\n        mprog.add_offset_assembly('FRAME37.4', 'FRAME38.1', 125, 'YZ.PLANE', 1, 144)\r\n        # FRAME2右邊角鐵\r\n        mprog.add_offset_assembly('FRAME33.1', 'FRAME2.1', 140, 'XZ.PLANE', 1, 145)\r\n        mprog.add_offset_assembly('FRAME33.1', 'FRAME15.1', -708, 'XY.PLANE', 0, 146)\r\n        mprog.add_offset_assembly('FRAME33.1', 'FRAME11.1', 313.984, 'YZ.PLANE', 0, 147)\r\n        # FRAME2中間半圓形零件\r\n        mprog.add_offset_assembly('FRAME40.1', 'FRAME20.1', 130.5, 'XZ.PLANE', 0, 148)\r\n        mprog.add_offset_assembly('FRAME40.1', 'FRAME20.1', -320, 'XY.PLANE', 0, 149)\r\n        mprog.add_offset_assembly('FRAME40.1', 'FRAME20.1', par.FRAME20_FRAME2_YZ[i], 'YZ.PLANE', 1, 150)\r\n        # FRAME35上兩圓管\r\n        mprog.add_offset_assembly('FRAME36.1', 'FRAME35.1', -272.236, 'XZ.PLANE', 1, 151)\r\n        mprog.add_offset_assembly('FRAME36.1', 'FRAME35.1', 272.236, 'XY.PLANE', 0, 152)\r\n        mprog.add_offset_assembly('FRAME36.1', 'FRAME35.1', 41, 'YZ.PLANE', 0, 153)\r\n        mprog.add_offset_assembly('FRAME36.2', 'FRAME35.1', 272.236, 'XZ.PLANE', 1, 154)\r\n        mprog.add_offset_assembly('FRAME36.2', 'FRAME35.1', 272.236, 'XY.PLANE', 0, 155)\r\n        mprog.add_offset_assembly('FRAME36.2', 'FRAME35.1', 41, 'YZ.PLANE', 0, 156)\r\n        # 後方馬達下支撐板上治具\r\n        mprog.add_offset_assembly('Fixture.1', 'FRAME41.1', 95, 'XZ.PLANE', 0, 157)\r\n        mprog.add_offset_assembly('Fixture.1', 'FRAME41.1', 22 + 18, 'XY.PLANE', 0, 158)\r\n        mprog.add_offset_assembly('Fixture.1', 'FRAME41.1', 312.5, 'YZ.PLANE', 0, 159)\r\n        # 馬達下方板與後方橫板\r\n        mprog.add_offset_assembly('FRAME42.1', 'FRAME41.1', 0, 'XZ.PLANE', 1, 160)\r\n        mprog.add_offset_assembly('FRAME42.1', 'FRAME41.1', 71.5, 'XY.PLANE', 1, 161)\r\n        mprog.add_offset_assembly('FRAME42.1', 'FRAME41.1', -19, 'YZ.PLANE', 1, 162)\r\n        # 平板2, 3組立\r\n        mprog.add_offset_assembly('BOLSTER2.1', 'BOLSTER3.1', 0, 'XZ.PLANE', 0, 163)\r\n        mprog.add_offset_assembly('BOLSTER2.1', 'BOLSTER3.1', 0, 'XY.PLANE', 0, 164)\r\n        mprog.add_offset_assembly('BOLSTER2.1', 'BOLSTER3.1', 0, 'YZ.PLANE', 0, 165)\r\n        # 平板1, 3組立\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'BOLSTER3.1', 0, 'XZ.PLANE', 0, 166)\r\n        mprog.add_offset_assembly('BOLSTER1.1', 'BOLSTER3.1', 0, 'YZ.PLANE', 0, 167)\r\n        # if k == 0:\r\n        if h == 0:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'BOLSTER3.1', par.DH_S[i], 'XY.PLANE', 0, 168)\r\n        elif h == 1:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'BOLSTER3.1', par.DH_H[i], 'XY.PLANE', 0, 168)\r\n        else:\r\n            mprog.add_offset_assembly('BOLSTER1.1', 'BOLSTER3.1', par.DH_P[i], 'XY.PLANE', 0, 168)\r\n        # SLIDE跟平板3組立\r\n        if i == 4:\r\n            mprog.add_offset_product_assembly('SLIDE_UNIT_All.1', 'Geometrical Set.1', 'BOLSTER3.1', 267.38, 'XY.PLANE',\r\n                                              1, 169)\r\n        else:\r\n            mprog.add_offset_product_assembly('SLIDE_UNIT_All.1', 'Geometrical Set.1', 'BOLSTER3.1', 85, 'XY.PLANE', 1,\r\n                                              170)\r\n        mprog.add_offset_product_assembly('SLIDE_UNIT_All.1', 'Geometrical Set.1', 'BOLSTER3.1', 0, 'XZ.PLANE', 1, 171)\r\n        if i == 4:\r\n            mprog.add_offset_product_assembly('SLIDE_UNIT_All.1', 'Geometrical Set.1', 'BOLSTER3.1', 138.171,\r\n                                              'YZ.PLANE', 0, 172)\r\n        else:\r\n            mprog.add_offset_product_assembly('SLIDE_UNIT_All.1', 'Geometrical Set.1', 'BOLSTER3.1', 0, 'YZ.PLANE', 0,\r\n                                              172)\r\n        # 時鐘跟FRAME20組立\r\n        mprog.add_offset_product_assembly('CRANK_SHAFT_CLOCK.1', 'Geometrical Set.2', 'FRAME20.1', 0, 'XZ.PLANE', 0,\r\n                                          173)\r\n        mprog.add_offset_product_assembly('CRANK_SHAFT_CLOCK.1', 'Geometrical Set.2', 'FRAME20.1',  37, 'YZ.PLANE', 0,\r\n                                          174)\r\n        mprog.add_offset_product_assembly('CRANK_SHAFT_CLOCK.1', 'Geometrical Set.2', 'FRAME20.1', -(par.H[i] - 34 - par.S[i] - par.Z[i]), 'XY.PLANE',\r\n                                          0, 175)\r\n        # 氣壓缸跟FRAME20組立\r\n        if i == 4:\r\n            mprog.add_offset_product_assembly('BALANCER_RIGHT_All.1', 'Geometrical Set.1', 'FRAME20.1', -87.5,\r\n                                              'XY.PLANE', 1, 176)\r\n        else:\r\n            mprog.add_offset_product_assembly('BALANCER_RIGHT_All.1', 'Geometrical Set.1', 'FRAME20.1', -32, 'XY.PLANE',\r\n                                              1, 176)\r\n        if i == 4:\r\n            if l == 0:\r\n                mprog.add_offset_product_assembly('BALANCER_RIGHT_All.1', 'Geometrical Set.1', 'FRAME20.1', -500.5,\r\n                                                  'XZ.PLANE', 0, 177)\r\n            else:\r\n                mprog.add_offset_product_assembly('BALANCER_RIGHT_All.1', 'Geometrical Set.1', 'FRAME20.1', -347,\r\n                                                  'XZ.PLANE', 0, 177)\r\n        else:\r\n            if l == 0:\r\n                mprog.add_offset_product_assembly('BALANCER_RIGHT_All.1', 'Geometrical Set.1', 'FRAME20.1',\r\n                                                  -par.R_15[i] / 2 - 13, 'XZ.PLANE', 0, 178)\r\n            else:\r\n                mprog.add_offset_product_assembly('BALANCER_RIGHT_All.1', 'Geometrical Set.1', 'FRAME20.1',\r\n                                                  -par.R[i] / 2 - 13, 'XZ.PLANE', 0, 178)\r\n        if i == 4:\r\n            mprog.add_offset_product_assembly('BALANCER_RIGHT_All.1', 'Geometrical Set.1', 'FRAME20.1', -261.248,\r\n                                              'YZ.PLANE', 0, 179)\r\n        else:\r\n            mprog.add_offset_product_assembly('BALANCER_RIGHT_All.1', 'Geometrical Set.1', 'FRAME20.1', -260,\r\n                                              'YZ.PLANE', 0, 179)\r\n        if i == 4:\r\n            mprog.add_offset_product_assembly('BALANCER_LEFT_All.1', 'Geometrical Set.1', 'FRAME20.1', -21.8,\r\n                                              'XY.PLANE', 1, 180)\r\n        else:\r\n            mprog.add_offset_product_assembly('BALANCER_LEFT_All.1', 'Geometrical Set.1', 'FRAME20.1', -32, 'XY.PLANE',\r\n                                              1, 180)\r\n        if i == 4:\r\n            if l == 0:\r\n                mprog.add_offset_product_assembly('BALANCER_LEFT_All.1', 'Geometrical Set.1', 'FRAME20.1', -500.5,\r\n                                                  'XZ.PLANE', 1, 181)\r\n            else:\r\n                mprog.add_offset_product_assembly('BALANCER_LEFT_All.1', 'Geometrical Set.1', 'FRAME20.1', -347,\r\n                                                  'XZ.PLANE', 1, 181)\r\n        else:\r\n            if l == 0:\r\n                mprog.add_offset_product_assembly('BALANCER_LEFT_All.1', 'Geometrical Set.1', 'FRAME20.1',\r\n                                                  -par.R_15[i] / 2 - 13, 'XZ.PLANE', 1, 182)\r\n            else:\r\n                mprog.add_offset_product_assembly('BALANCER_LEFT_All.1', 'Geometrical Set.1', 'FRAME20.1',\r\n                                                  -par.R[i] / 2 - 13, 'XZ.PLANE', 1, 182)\r\n        if i == 4:\r\n            mprog.add_offset_product_assembly('BALANCER_LEFT_All.1', 'Geometrical Set.1', 'FRAME20.1', 261.248,\r\n                                              'YZ.PLANE', 1, 183)\r\n        else:\r\n            mprog.add_offset_product_assembly('BALANCER_LEFT_All.1', 'Geometrical Set.1', 'FRAME20.1', 260, 'YZ.PLANE',\r\n                                              1, 183)\r\n        # 離合器與FRAME20結合\r\n        mprog.add_offset_product_assembly('CLUCTH_ASSEMBLY_All.1', 'Geometrical Set.1', 'FRAME20.1', -(par.H[i] - par.Z[i] - par.S[i] - 34 - 5 + 448), 'XY.PLANE',\r\n                                              0, 184)\r\n        mprog.add_offset_product_assembly('CLUCTH_ASSEMBLY_All.1', 'Geometrical Set.1', 'FRAME20.1', 0, 'XZ.PLANE', 1,\r\n                                          185)\r\n        mprog.add_offset_product_assembly('CLUCTH_ASSEMBLY_All.1', 'Geometrical Set.1', 'FRAME20.1', 512, 'YZ.PLANE', 1,\r\n                                          186)\r\n        # 曲軸與時鐘結合\r\n        mprog.add_offset_product_assembly('CRANK_SHAFT_CLOCK.1', 'Geometrical Set.2', 'CRANK_SHAFT.1.1', 0, 'XZ.PLANE',\r\n                                          0, 187)\r\n        mprog.add_offset_product_assembly('CRANK_SHAFT_CLOCK.1', 'Geometrical Set.2', 'CRANK_SHAFT.1.1', 35, 'YZ.PLANE',\r\n                                          1, 188)\r\n        mprog.add_offset_product_assembly('CRANK_SHAFT_CLOCK.1', 'Geometrical Set.2', 'CRANK_SHAFT.1.1', 0, 'XY.PLANE',\r\n                                          1, 189)\r\n        # 大齒輪結合\r\n        mprog.add_offset_assembly('MAIN_GEAR1.1', 'MAIN_GEAR4.1', 0, 'XZ.PLANE', 0, 190)\r\n        mprog.add_offset_assembly('MAIN_GEAR1.1', 'MAIN_GEAR4.1', 77.172, 'XY.PLANE', 0, 191)\r\n        mprog.add_offset_assembly('MAIN_GEAR1.1', 'MAIN_GEAR4.1', 0, 'YZ.PLANE', 1, 192)\r\n        # 大齒輪結合曲軸\r\n        mprog.add_offset_assembly('MAIN_GEAR1.1', 'CRANK_SHAFT.1.1', 0, 'XZ.PLANE', 1, 193)\r\n        mprog.add_offset_assembly('MAIN_GEAR1.1', 'CRANK_SHAFT.1.1', 0, 'XY.PLANE', 0, 194)\r\n        mprog.add_offset_assembly('MAIN_GEAR1.1', 'FRAME20.1', 592.5 + 150, 'YZ.PLANE', 1, 195)\r\n        # 機架20結合曲軸旁圓管\r\n        mprog.add_offset_assembly('MAIN_GEAR2.1', 'FRAME20.1', 0, 'XZ.PLANE', 0, 196)\r\n        mprog.add_offset_assembly('MAIN_GEAR2.1', 'FRAME20.1', par.H[i] - par.Z[i] - par.S[i] - 34, 'XY.PLANE', 1, 197)\r\n        mprog.add_offset_assembly('MAIN_GEAR2.1', 'FRAME20.1', 510, 'YZ.PLANE', 1, 198)\r\n        # 大齒輪結合長棒\r\n        mprog.add_offset_assembly('MAIN_GEAR1.1', 'JOINT1.1', 0, 'XZ.PLANE', 0, 199)\r\n        mprog.add_offset_assembly('MAIN_GEAR1.1', 'JOINT1.1', 0, 'XY.PLANE', 1, 200)\r\n        mprog.add_offset_assembly('MAIN_GEAR1.1', 'JOINT1.1', -84, 'YZ.PLANE', 1, 201)\r\n        #\r\n        mprog.add_offset_product_assembly('JOINT_All.1', 'Geometrical Set.1', 'FRAME20.1', 0, 'XZ.PLANE',\r\n                                          0, 202)\r\n        mprog.add_offset_product_assembly('JOINT_All.1', 'Geometrical Set.1', 'FRAME20.1', 1010, 'YZ.PLANE',\r\n                                          1, 203)\r\n        mprog.add_offset_product_assembly('JOINT_All.1', 'Geometrical Set.1', 'FRAME20.1', -(par.H[i] - par.Z[i] - par.S[i] - 34), 'XY.PLANE',\r\n                                          0, 204)\r\n        # 大齒輪內套環\r\n        mprog.add_offset_assembly('MAIN_GEAR2.1', 'MAIN_GEAR3.1', 0, 'XZ.PLANE', 1, 205)\r\n        mprog.add_offset_assembly('MAIN_GEAR2.1', 'MAIN_GEAR3.1', 0, 'XY.PLANE', 0, 206)\r\n        mprog.add_offset_assembly('MAIN_GEAR2.1', 'MAIN_GEAR3.1', 11, 'YZ.PLANE', 1, 207)\r\n        # BOLSTER後板\r\n        mprog.add_offset_assembly('FRAME45.1', 'FRAME17.1', 0, 'XZ.PLANE', 0, 208)\r\n        mprog.add_offset_assembly('FRAME45.1', 'FRAME17.1', -48, 'XY.PLANE', 1, 209)\r\n        mprog.add_offset_assembly('FRAME45.1', 'FRAME17.1', 0, 'YZ.PLANE', 1, 210)\r\n        #\r\n        mprog.add_offset_assembly('FRAME46.1', 'FRAME17.1', -48, 'XY.PLANE', 1, 211)\r\n        mprog.add_offset_assembly('FRAME46.1', 'FRAME17.1', 0, 'XZ.PLANE', 0, 212)\r\n        mprog.add_offset_assembly('FRAME46.1', 'FRAME17.1', 0, 'YZ.PLANE', 1, 213)\r\n        #\r\n        mprog.add_offset_assembly('FRAME20.1', 'FRAME44.1', 5, 'XY.PLANE', 0, 214)\r\n        mprog.add_offset_assembly('FRAME20.1', 'FRAME44.1', 0, 'XZ.PLANE', 0, 215)\r\n        mprog.add_offset_assembly('FRAME20.1', 'FRAME44.1', 979, 'YZ.PLANE', 1, 216)\r\n        #\r\n        mprog.add_offset_assembly('FRAME26.1', 'FRAME47.1', 29, 'XY.PLANE', 1, 217)\r\n        mprog.add_offset_assembly('FRAME26.1', 'FRAME47.1', 35, 'XZ.PLANE', 0, 218)\r\n        mprog.add_offset_assembly('FRAME26.1', 'FRAME47.1', -99.35, 'YZ.PLANE', 1, 219)\r\n        mprog.add_offset_assembly('FRAME24.1', 'FRAME47.2', 29, 'XY.PLANE', 0, 220)\r\n        mprog.add_offset_assembly('FRAME24.1', 'FRAME47.2', -35, 'XZ.PLANE', 1, 221)\r\n        mprog.add_offset_assembly('FRAME24.1', 'FRAME47.2', 099.35, 'YZ.PLANE', 0, 222)\r\n        # 方管\r\n        mprog.add_offset_assembly('FRAME44.1', 'FRAME48.1', 124, 'XY.PLANE', 1, 223)\r\n        mprog.add_offset_assembly('FRAME44.1', 'FRAME48.1', 159 + 16, 'XZ.PLANE', 0, 224)\r\n        mprog.add_offset_assembly('FRAME44.1', 'FRAME48.1', -32, 'YZ.PLANE', 0, 225)\r\n        # 圓柱\r\n        mprog.add_offset_assembly('FRAME44.1', 'FRAME49.1', 220, 'XY.PLANE', 0, 226)\r\n        mprog.add_offset_assembly('FRAME44.1', 'FRAME49.1', 145, 'XZ.PLANE', 0, 227)\r\n        mprog.add_offset_assembly('FRAME44.1', 'FRAME49.1', -32, 'YZ.PLANE', 0, 228)\r\n\r\n        # 更新\r\n        mprog.update()\r\n        mprog.Close_All()\r\n        # 儲存Product檔\r\n        mprog.saveas(part_path, type, '.CATProduct')\r\n\r\n        # --------------------------------------- 生成爆炸圖-------------------------------------------\r\n        # 重新定義拘束尺寸\r\n        BOLSTER1_Offset_value = 1750\r\n        GIB_Offset_value = -3000\r\n        Behide_GIB_Offset_value = GIB_Offset_value - 334.5 - 65 + 109.85\r\n        CLOCK_Offset_value = 2850\r\n        CLOCK_SHAFT_Offset_value = CLOCK_Offset_value - 1350\r\n        BOLSTER1_XY_Z = -par.T[i]\r\n        BOLSTER1_XY_T = par.Z[i] - par.T[i] + BOLSTER1_XY_Z\r\n        BOLSTER1_XY = BOLSTER1_XY_T + par.DH_S[i]\r\n        BALANCER = -1700\r\n        if l == 1:\r\n            mprog.constaint_value_change(3, -par.B[i] - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(6, -par.B[i] - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(36, -BOLSTER1_Offset_value - par.F[i] / 2 + 80, 1)\r\n            mprog.constaint_value_change(39, -BOLSTER1_Offset_value - par.F[i] / 2 + 80, 1)\r\n            mprog.constaint_value_change(63, -par.F[i] / 2 - 80 - 37.5 - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(66, -par.F[i] / 2 - 80 - 37.5 - BOLSTER1_Offset_value, 0)\r\n            mprog.constaint_value_change(60, -37.5 - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(69, -37.5 - BOLSTER1_Offset_value, 0)\r\n            mprog.constaint_value_change(75, GIB_Offset_value + 45, 0)\r\n            mprog.constaint_value_change(78, GIB_Offset_value + 45, 0)\r\n            mprog.constaint_value_change(84, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(87, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(81, Behide_GIB_Offset_value, 0)\r\n            mprog.constaint_value_change(96, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(102, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(99, Behide_GIB_Offset_value, 0)\r\n            mprog.constaint_value_change(174, CLOCK_Offset_value, 0)\r\n            mprog.constaint_value_change(188, CLOCK_SHAFT_Offset_value, 1)\r\n            mprog.constaint_value_change(176, BALANCER, 1)  # 右氣壓缸\r\n            mprog.constaint_value_change(180, BALANCER, 1)  # 左氣壓缸\r\n            mprog.constaint_value_change(2, BOLSTER1_XY_Z, 1)\r\n            mprog.constaint_value_change(5, BOLSTER1_XY_Z, 0)\r\n            mprog.constaint_value_change(8, BOLSTER1_XY_Z, 1)\r\n            mprog.constaint_value_change(11, BOLSTER1_XY_Z, 0)\r\n            mprog.constaint_value_change(26, BOLSTER1_XY_T, 1)\r\n            mprog.constaint_value_change(29, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(35, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(38, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(56, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(59, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(62, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(65, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(68, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(71, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(168, BOLSTER1_XY, 0)\r\n        else:\r\n            mprog.constaint_value_change(3, -par.B_15[i] - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(6, -par.B_15[i] - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(36, -BOLSTER1_Offset_value - par.F[i] / 2 + 80, 1)\r\n            mprog.constaint_value_change(39, -BOLSTER1_Offset_value - par.F[i] / 2 + 80, 1)\r\n            mprog.constaint_value_change(63, -par.F[i] / 2 - 80 - 37.5 - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(66, -par.F[i] / 2 - 80 - 37.5 - BOLSTER1_Offset_value, 0)\r\n            mprog.constaint_value_change(60, -37.5 - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(69, -37.5 - BOLSTER1_Offset_value, 0)\r\n            mprog.constaint_value_change(75, GIB_Offset_value + 45, 0)\r\n            mprog.constaint_value_change(78, GIB_Offset_value + 45, 0)\r\n            mprog.constaint_value_change(84, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(87, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(81, Behide_GIB_Offset_value, 0)\r\n            mprog.constaint_value_change(96, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(102, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(99, Behide_GIB_Offset_value, 0)\r\n            mprog.constaint_value_change(174, CLOCK_Offset_value, 0)\r\n            mprog.constaint_value_change(188, CLOCK_SHAFT_Offset_value, 1)\r\n            mprog.constaint_value_change(176, BALANCER, 1)  # 右氣壓缸\r\n            mprog.constaint_value_change(180, BALANCER, 1)  # 左氣壓缸\r\n            mprog.constaint_value_change(2, BOLSTER1_XY_Z, 1)\r\n            mprog.constaint_value_change(5, BOLSTER1_XY_Z, 0)\r\n            mprog.constaint_value_change(8, BOLSTER1_XY_Z, 1)\r\n            mprog.constaint_value_change(11, BOLSTER1_XY_Z, 0)\r\n            mprog.constaint_value_change(26, BOLSTER1_XY_T, 1)\r\n            mprog.constaint_value_change(29, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(35, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(38, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(56, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(59, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(62, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(65, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(68, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(71, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(168, BOLSTER1_XY, 0)\r\n\r\n        mprog.update()  # 更新\r\n        mprog.OPEN_Drawing()\r\n        if l == 1:\r\n            drafting_Coordinate_Position, drafting_isometric_Coordinate_Position, scale = draft.drafting_parameter_calculation(par.A[i], par.B[i], par.H[i], par.T[i])  # 計算爆炸圖比例及位置\r\n        else :\r\n            drafting_Coordinate_Position, drafting_isometric_Coordinate_Position, scale = draft.drafting_parameter_calculation(\r\n                par.A_15[i], par.B_15[i], par.H[i], par.T[i])  # 計算爆炸圖比例及位置\r\n\r\n        draft.change_Drawing_scale(1 / scale)  # 圖面比例\r\n        draft.exploded_Drawing_1(type, drafting_isometric_Coordinate_Position['exploded_1'][0],\r\n                                 drafting_isometric_Coordinate_Position['exploded_1'][1], scale)  # 爆炸圖1\r\n        mprog.switch_window()  # 開啟3D圖視窗\r\n        # # 還原零件初始位置\r\n        BOLSTER1_Offset_value = 80 - par.F[i] / 2\r\n        GIB_Offset_value = 334.5 - 45\r\n        CLOCK_Offset_value = 35\r\n        CLOCK_SHAFT_Offset_value = 45\r\n        Behide_GIB_Offset_value = GIB_Offset_value - 334.5 - 65 + 109.85\r\n        BOLSTER1_XY_Z = - par.Z[i]\r\n        BOLSTER1_XY_T = -par.T[i]\r\n        BOLSTER1_XY = par.DH_S[i]\r\n        BALANCER = -32\r\n        if l == 1:\r\n            mprog.constaint_value_change(3, -par.B[i] - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(6, -par.B[i] - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(36, -BOLSTER1_Offset_value - par.F[i] / 2 + 80, 1)\r\n            mprog.constaint_value_change(39, -BOLSTER1_Offset_value - par.F[i] / 2 + 80, 1)\r\n            mprog.constaint_value_change(63, -par.F[i] / 2 - 80 - 37.5 - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(66, -par.F[i] / 2 - 80 - 37.5 - BOLSTER1_Offset_value, 0)\r\n            mprog.constaint_value_change(60, -37.5 - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(69, -37.5 - BOLSTER1_Offset_value, 0)\r\n            mprog.constaint_value_change(75, GIB_Offset_value + 45, 0)\r\n            mprog.constaint_value_change(78, GIB_Offset_value + 45, 0)\r\n            mprog.constaint_value_change(84, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(87, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(81, Behide_GIB_Offset_value, 0)\r\n            mprog.constaint_value_change(96, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(102, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(99, Behide_GIB_Offset_value, 0)\r\n            mprog.constaint_value_change(174, CLOCK_Offset_value, 0)\r\n            mprog.constaint_value_change(188, CLOCK_SHAFT_Offset_value, 1)\r\n            mprog.constaint_value_change(176, BALANCER, 1)  # 右氣壓缸\r\n            mprog.constaint_value_change(180, BALANCER, 1)  # 左氣壓缸\r\n            mprog.constaint_value_change(2, BOLSTER1_XY_Z, 1)\r\n            mprog.constaint_value_change(5, BOLSTER1_XY_Z, 0)\r\n            mprog.constaint_value_change(8, BOLSTER1_XY_Z, 1)\r\n            mprog.constaint_value_change(11, BOLSTER1_XY_Z, 0)\r\n            mprog.constaint_value_change(26, BOLSTER1_XY_T, 1)\r\n            mprog.constaint_value_change(29, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(35, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(38, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(56, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(59, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(62, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(65, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(68, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(71, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(168, BOLSTER1_XY, 0)\r\n        else :\r\n            mprog.constaint_value_change(3, -par.B_15[i] - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(6, -par.B_15[i] - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(36, -BOLSTER1_Offset_value - par.F[i] / 2 + 80, 1)\r\n            mprog.constaint_value_change(39, -BOLSTER1_Offset_value - par.F[i] / 2 + 80, 1)\r\n            mprog.constaint_value_change(63, -par.F[i] / 2 - 80 - 37.5 - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(66, -par.F[i] / 2 - 80 - 37.5 - BOLSTER1_Offset_value, 0)\r\n            mprog.constaint_value_change(60, -37.5 - BOLSTER1_Offset_value, 1)\r\n            mprog.constaint_value_change(69, -37.5 - BOLSTER1_Offset_value, 0)\r\n            mprog.constaint_value_change(75, GIB_Offset_value + 45, 0)\r\n            mprog.constaint_value_change(78, GIB_Offset_value + 45, 0)\r\n            mprog.constaint_value_change(84, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(87, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(81, Behide_GIB_Offset_value, 0)\r\n            mprog.constaint_value_change(96, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(102, Behide_GIB_Offset_value, 1)\r\n            mprog.constaint_value_change(99, Behide_GIB_Offset_value, 0)\r\n            mprog.constaint_value_change(174, CLOCK_Offset_value, 0)\r\n            mprog.constaint_value_change(188, CLOCK_SHAFT_Offset_value, 1)\r\n            mprog.constaint_value_change(176, BALANCER, 1)  # 右氣壓缸\r\n            mprog.constaint_value_change(180, BALANCER, 1)  # 左氣壓缸\r\n            mprog.constaint_value_change(2, BOLSTER1_XY_Z, 1)\r\n            mprog.constaint_value_change(5, BOLSTER1_XY_Z, 0)\r\n            mprog.constaint_value_change(8, BOLSTER1_XY_Z, 1)\r\n            mprog.constaint_value_change(11, BOLSTER1_XY_Z, 0)\r\n            mprog.constaint_value_change(26, BOLSTER1_XY_T, 1)\r\n            mprog.constaint_value_change(29, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(35, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(38, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(56, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(59, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(62, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(65, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(68, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(71, BOLSTER1_XY_T, 0)\r\n            mprog.constaint_value_change(168, BOLSTER1_XY, 0)\r\n        mprog.update()\r\n        # # # --------------------爆炸圖右圖------------------\r\n\r\n        Fixture_offset_value = 2850\r\n        CLUCTH_ASSEMBLY_offset_value = par.B[i] + 1650\r\n        CLUCTH_ASSEMBLY_offset_15_value = par.B_15[i] + 1650\r\n        JOINT_ALL_offset_value = CLUCTH_ASSEMBLY_offset_value\r\n        MAIN_GEAR_offset_value = par.B[i] + 850\r\n        MAIN_GEAR_offset_15_value = par.B_15[i] + 850\r\n        if l == 1:\r\n            mprog.constaint_value_change(159, -312.5 - Fixture_offset_value, 0)  # 支架\r\n            mprog.constaint_value_change(186, CLUCTH_ASSEMBLY_offset_value, 1)  # 離合器\r\n            mprog.constaint_value_change(203, JOINT_ALL_offset_value, 1)  # JOINT_All.1\r\n            mprog.constaint_value_change(195, MAIN_GEAR_offset_value, 1)  # 大齒輪MAIN_GEA1\r\n            mprog.constaint_value_change(201, -375, 1)  # Joint1\r\n        else:\r\n            mprog.constaint_value_change(159, -312.5 - Fixture_offset_value, 0)  # 支架\r\n            mprog.constaint_value_change(186, CLUCTH_ASSEMBLY_offset_15_value, 1)  # 離合器\r\n            mprog.constaint_value_change(203, JOINT_ALL_offset_value, 1)  # JOINT_All.1\r\n            mprog.constaint_value_change(195, MAIN_GEAR_offset_15_value, 1)  # 大齒輪MAIN_GEA1\r\n            mprog.constaint_value_change(201, -375, 1)  # Joint1\r\n        mprog.update()\r\n        mprog.switch_window()\r\n        draft.exploded_Drawing_2(type, drafting_isometric_Coordinate_Position['exploded_2'][0],\r\n                                 drafting_isometric_Coordinate_Position['exploded_2'][1], scale)  # 爆炸圖2\r\n        # 復原位置\r\n        mprog.switch_window()\r\n        mprog.constaint_value_change(159, 312.5, 0)  # 支架\r\n        mprog.constaint_value_change(186, 510, 1)  # 離合器\r\n        mprog.constaint_value_change(203, 1010, 1)  # JOINT_All.1\r\n        mprog.constaint_value_change(195, 592.5 + 150, 1)  # 大齒輪MAIN_GEA1\r\n        mprog.constaint_value_change(201, -84, 1)  # Joint1\r\n        mprog.update()\r\n        mprog.switch_window()\r\n        # # --------------------爆炸圖下(前、左、右)----------------\r\n        draft.Front_View_Drawing(type, drafting_Coordinate_Position['Front View'][0],\r\n                                 drafting_Coordinate_Position['Front View'][1], scale)\r\n        draft.Left_View_Drawing(type, drafting_Coordinate_Position['Left View'][0],\r\n                                drafting_Coordinate_Position['Left View'][1], scale)\r\n        draft.Right_View_Drawing(type, drafting_Coordinate_Position['Right View'][0],\r\n                                 drafting_Coordinate_Position['Right View'][1], scale)\r\n\r\n        # ------------圈碼圖------------\r\n        sin45 = math.sin(math.radians(45))\r\n        cos45 = math.cos(math.radians(45))\r\n        sin30 = math.sin(math.radians(30))\r\n        cos30 = math.cos(math.radians(30))\r\n        sin60 = math.sin(math.radians(60))\r\n        cos60 = math.cos(math.radians(60))\r\n        cos35_267 = math.cos(math.radians(35.267))\r\n        sin35_267 = math.sin(math.radians(35.267))\r\n\r\n        BOLSTER1_Offset_value = 1750\r\n        BLOSTER1_center_Offset_Value = 1775\r\n        GIB_Offset_value = -3000\r\n        Behide_GIB_Offset_value = GIB_Offset_value - 334.5 - 65 + 109.85\r\n        CLOCK_Offset_value = 2850\r\n        CLOCK_SHAFT_Offset_value = CLOCK_Offset_value - 1350\r\n        BOLSTER1_XY_Z = -par.T[i]\r\n        BOLSTER1_XY_T = par.Z[i] - par.T[i] + BOLSTER1_XY_Z\r\n        BOLSTER1_XY = BOLSTER1_XY_T + par.DH_S[i]\r\n\r\n        balloons_posotion = [750 * cos30, 750 * sin30]\r\n        CLOCK_Pointer = 3325\r\n        FRAME_TOP_LEFT_X = (par.R[i] + 90 + 50) * cos45 + 50\r\n        FRAME_TOP_LEFT_X_1 = FRAME_TOP_LEFT_X * sin30 / cos30\r\n\r\n        scale = 1 / scale\r\n\r\n        # (將3D圖面尺寸轉換為2D尺寸, 將圖面x座標尺寸轉為R再將R轉為Y)\r\n        # 引線點座標\r\n        point_position = {'2': [-CLOCK_Offset_value * cos45,\r\n                                -CLOCK_Offset_value * cos45 * sin30 / cos30],\r\n                          '3': [(-1250) * cos45,\r\n                                (-1250) * cos45 * sin30 / cos30],\r\n                          '4': [(-BOLSTER1_Offset_value - par.R[i] / 2) * cos45,\r\n                                (-BOLSTER1_Offset_value - par.R[i] / 2) * cos45 * sin30 / cos30],\r\n                          '5': [(-BOLSTER1_Offset_value - par.R[i]) * cos45,\r\n                                (-BOLSTER1_Offset_value - par.R[i]) * cos45 * sin30 / cos30 - par.S[i] + par.T[i]],\r\n                          '6': [(GIB_Offset_value - (par.R[i] + 145) / 2) * cos45,\r\n                                (GIB_Offset_value - (par.R[i] + 145) / 2) * cos45 * sin30 / cos30]}\r\n        # 圈圈座標\r\n        circle_position = {\r\n            '2': ['2', point_position['2'][0] - FRAME_TOP_LEFT_X, point_position['2'][1] + FRAME_TOP_LEFT_X_1],\r\n            '3': ['3', point_position['3'][0] - FRAME_TOP_LEFT_X, point_position['3'][1] + FRAME_TOP_LEFT_X_1],\r\n            '4': ['4', point_position['4'][0] - FRAME_TOP_LEFT_X, point_position['4'][1] + FRAME_TOP_LEFT_X_1],\r\n            '5': ['5', point_position['5'][0] * 2 * 0.9 - FRAME_TOP_LEFT_X,\r\n                  point_position['5'][0] * 2 * 0.9 * sin30 / cos30 + FRAME_TOP_LEFT_X_1],\r\n            '6': ['6', point_position['6'][0] - FRAME_TOP_LEFT_X, point_position['6'][1] + FRAME_TOP_LEFT_X_1]}\r\n\r\n        draft.balloons('Isometric view1', circle_position['6'][0], circle_position['6'][1], circle_position['6'][2],\r\n                       point_position['6'][0], point_position['6'][1], circle_position['6'][1])\r\n        draft.balloons('Isometric view1', circle_position['2'][0], circle_position['2'][1], circle_position['2'][2],\r\n                       point_position['2'][0], point_position['2'][1], circle_position['2'][1])\r\n        draft.balloons('Isometric view1', circle_position['4'][0], circle_position['4'][1], circle_position['4'][2],\r\n                       point_position['4'][0], point_position['4'][1], circle_position['4'][1])\r\n        draft.balloons('Isometric view1', circle_position['5'][0], circle_position['5'][1], circle_position['5'][2],\r\n                       point_position['5'][0], point_position['5'][1], circle_position['5'][1])\r\n        draft.balloons('Isometric view1', circle_position['3'][0], circle_position['3'][1], circle_position['3'][2],\r\n                       point_position['3'][0], point_position['3'][1], circle_position['3'][1])\r\n\r\n        # ------------中心線-------------\r\n        draft.create_center_line('Isometric view1', 0, 0, -CLOCK_Pointer * cos45,\r\n                                 -CLOCK_Pointer * cos45 * sin30 / cos30)\r\n        draft.create_center_line('Isometric view1', -BLOSTER1_center_Offset_Value * cos45,\r\n                                 -BLOSTER1_center_Offset_Value * cos45 * sin30 / cos30,\r\n                                 -BLOSTER1_center_Offset_Value * cos45, -par.S[i] - par.Z[i] - par.T[i])\r\n        draft.create_center_line('Isometric view2', -742.5 * cos45, -742.5 * cos45 * sin30 / cos30,\r\n                                 -JOINT_ALL_offset_value * cos45, -JOINT_ALL_offset_value * cos45 * sin30 / cos30)\r\n        draft.create_center_line('Isometric view2', -742.5 * cos45, -742.5 * cos45 * sin30 / cos30 - 300,\r\n                                 -(Fixture_offset_value + par.B[i]) * cos45,\r\n                                 -(Fixture_offset_value + par.B[i]) * cos45 * sin30 / cos30 - 300)\r\n\r\n        Left_view_list = []\r\n        for x in Left_view_list:\r\n            Left_view_list.append(x)\r\n\r\n        for x in Left_view_list:\r\n            draft.add_dimension_to_view('Left view', str(x), Left_view_list[x][0], Left_view_list[x][1], Left_view_list[x][2],\r\n                                        Left_view_list[x][3], Left_view_list[x][4], Left_view_list[x][5])\r\n        # -------------關閉虛框---------------\r\n        view_name = ['Isometric view1', 'Isometric view2', 'Front view', 'Left view', 'Right view']\r\n        for x in view_name:\r\n            draft.close_broken_line_block_diagram(x)\r\n\r\n\r\n        #--------------存檔------------------\r\n        mprog.PDF_save(path, \"Exploded_Views\")\r\n        mprog.save_detail_drawing(path , \"Exploded_Views\")\r\n\r\n        #-------------\r\n        # dp.Parts_drawing_generation(i , j , path)\r\n\r\n        #-----------零件圖生成--------\r\n        mprog.OPEN_detail_drawing()\r\n        dp.Parts_drawing_generation(i, l, part_path)\r\n        dpc.bom_text_create()\r\n        mprog.PDF_save(path, \"detail_drawing\")\r\n        mprog.save_detail_drawing(path , \"detail_drawing\")\r\n\r\nif __name__ == \"__main__\":\r\n    QtCore.QCoreApplication.setAttribute(QtCore.Qt.AA_EnableHighDpiScaling)  # 自適應屏幕分辨率\r\n    app = QtWidgets.QApplication([])\r\n    window = main()\r\n    window.show()\r\n    sys.exit(app.exec_())
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SYEI_stamping_press_system/main_GUI.py b/SYEI_stamping_press_system/main_GUI.py
--- a/SYEI_stamping_press_system/main_GUI.py	(revision 9b03e8114d34ddad78b2ae1878b096aad22932e2)
+++ b/SYEI_stamping_press_system/main_GUI.py	(date 1676254949662)
@@ -1118,6 +1118,133 @@
         mprog.PDF_save(path, "detail_drawing")
         mprog.save_detail_drawing(path , "detail_drawing")
 
+        # --------焊接圖---------
+        # 隱藏機架外零件
+        for part_name in par.hide_part_name:
+            mprog.hide_show_part(part_name, 1)
+
+        # 投影
+        mprog.OPEN_Welding_diagram()
+        drafting_down_Coordinate_Position, drafting_up_Coordinate_Position, scale = draft.drafting_welding_view_parameter_calculation(
+            par.A[i], par.B[i], par.H[i], par.S[i], par.Z[i], par.T[i])
+        draft.change_Drawing_scale(1 / scale)
+        # 副程式名稱須注意是否與立體圖相符
+        draft.Front_View_Drawing('SN1-110', drafting_down_Coordinate_Position['Right View'][0],
+                                 drafting_down_Coordinate_Position['Right View'][1], scale)  # 左側試圖
+        draft.Right_View_Drawing('SN1-110', drafting_down_Coordinate_Position['Front View'][0],
+                                 drafting_down_Coordinate_Position['Front View'][1], scale)  # 前視圖
+        draft.Right_Top_View_Drawing('SN1-110', drafting_up_Coordinate_Position['Top View'][0],
+                                     drafting_up_Coordinate_Position['Top View'][1], scale)  # 上視圖
+
+        # 剖面圖座標
+        Section_Coordinate = {'A-A': [[float(0), float(-2900), float(0), float(600)], 1],
+                              'B-B': [[float(par.B[i] + 100), float(520), float(par.B[i] + 100), float(-1200)], 0],
+                              'C-C': [
+                                  [float(-195), float(-par.S[i] + 100), float(par.B[i] + 100), float(-par.S[i] + 100)],
+                                  0],
+                              'D-D': [[float(-par.A[i] / 2 - 100), float(-par.H[i] / 2), float(par.A[i] / 2 + 100),
+                                       float(-par.H[i] / 2)], 1],
+                              'E-E': [[float(-100), float(-(par.S[i] + par.Z[i]) + 100), float(par.B[i] / 3),
+                                       float(-(par.S[i] + par.Z[i]) + 100)], 0],
+                              'F-F': [[float(272), float(- 176 / 2), float(272), float(-176 * 3 / 2)], 0],
+                              'G-G': [
+                                  [float(par.B[i] + 100), float(-(par.S[i] + par.Z[i]) + 200), float(par.B[i] + 100),
+                                   float(-(par.S[i] + par.Z[i]) - 200)], 0]}
+        Section_Coordinate_title = list(Section_Coordinate.keys())
+        view_order = ['Front view', 'Right view', 'Section view A-A', 'Front view', 'Right view', 'Section view B-B',
+                      'Section view A-A']
+        for title in Section_Coordinate_title:
+            for view_name in view_order:
+                if 'Section view ' + title in drafting_up_Coordinate_Position:  # 若此元素為此字典之鍵則執行
+                    draft.Section(view_name, drafting_up_Coordinate_Position['Section view ' + title][0],
+                                  drafting_up_Coordinate_Position['Section view ' + title][1], scale,
+                                  Section_Coordinate[title][0],
+                                  Section_Coordinate[title][1], 'Section view ' + title)
+                else:
+                    draft.Section(view_name, drafting_down_Coordinate_Position['Section view ' + title][0],
+                                  drafting_down_Coordinate_Position['Section view ' + title][1], scale,
+                                  Section_Coordinate[title][0],
+                                  Section_Coordinate[title][1], 'Section view ' + title)
+                view_order.pop(0)  # 刪除串列中第一個元素
+                break
+
+        # # 裁切選定圖面範圍
+        detail_view_coordinate = {
+            'Section view D-D': [float(par.A[i] / 2), float(-270), float(-par.A[i] / 2), float(-270),
+                                 float(-par.A[i] / 2),
+                                 float(-630), float(par.A[i] / 2), float(-630)],
+            'Section view F-F': [float(-979 + 42), float(-25), float(-979 + 42), float(-290), float(-54 - 979),
+                                 float(-290),
+                                 float(-979 - 54), float(-25)],
+            'Section view G-G': [float(-par.A[i] / 2 - par.FRAME_6_7_width[i]), float(-par.S[i] - par.Z[i] + 150),
+                                 float(-par.A[i] / 2 - par.FRAME_6_7_width[i]),
+                                 float(-par.S[i] - par.Z[i] - 150), float(-par.A[i] / 2 + par.FRAME_6_7_width[i] + 170),
+                                 float(-par.S[i] - par.Z[i] - 150), float(-par.A[i] / 2 + par.FRAME_6_7_width[i] + 170),
+                                 float(-par.S[i] - par.Z[i] + 150)]}
+        detail_view_coordinate_keys = list(detail_view_coordinate.keys())
+        for coordinate_keys in detail_view_coordinate_keys:
+            if coordinate_keys == 'Section view F-F' or coordinate_keys == 'Section view D-D':
+                mprog.switch_window()
+                if coordinate_keys == 'Section view F-F':
+                    for name in par.part_name_Section_view_F_F:
+                        mprog.hide_show_part(name, 1)
+                elif coordinate_keys == 'Section view D-D':
+                    for name in par.part_name_Section_view_D_D:
+                        mprog.hide_show_part(name, 1)
+                mprog.switch_window()
+                if coordinate_keys in drafting_up_Coordinate_Position:
+                    draft.Define_Polygonal_Detail_View(coordinate_keys, detail_view_coordinate[coordinate_keys],
+                                                       drafting_up_Coordinate_Position[coordinate_keys][0],
+                                                       drafting_up_Coordinate_Position[coordinate_keys][1])
+                else:
+                    draft.Define_Polygonal_Detail_View(coordinate_keys, detail_view_coordinate[coordinate_keys],
+                                                       drafting_down_Coordinate_Position[coordinate_keys][0],
+                                                       drafting_down_Coordinate_Position[coordinate_keys][1])
+                mprog.switch_window()
+                if coordinate_keys == 'Section view F-F':
+                    for name in par.part_name_Section_view_F_F:
+                        mprog.hide_show_part(name, 0)
+                elif coordinate_keys == 'Section view D-D':
+                    for name in par.part_name_Section_view_D_D:
+                        mprog.hide_show_part(name, 0)
+                mprog.switch_window()
+            else:
+                if coordinate_keys in drafting_up_Coordinate_Position:
+                    draft.Define_Polygonal_Detail_View(coordinate_keys, detail_view_coordinate[coordinate_keys],
+                                                       drafting_up_Coordinate_Position[coordinate_keys][0],
+                                                       drafting_up_Coordinate_Position[coordinate_keys][1])
+                else:
+                    draft.Define_Polygonal_Detail_View(coordinate_keys, detail_view_coordinate[coordinate_keys],
+                                                       drafting_down_Coordinate_Position[coordinate_keys][0],
+                                                       drafting_down_Coordinate_Position[coordinate_keys][1])
+
+        # 產生折斷線
+        # 注意:折斷線若為水平線，方框四角座標須以⌈水平⌋建立；折斷線若為垂直線，方框四角座標須以⌈垂直⌋建立
+        break_line_Coordinate = {'Section view E-E': [
+            [float(0), float(par.A[i] / 6), float(par.B[i] / 3), float(par.A[i] / 6), float(0), float(-par.A[i] / 6),
+             float(par.B[i] / 3), float(-par.A[i] / 6)], 0, 1]}
+        print(break_line_Coordinate['Section view E-E'][0][0:])
+        draft.break_line('Section view E-E', break_line_Coordinate['Section view E-E'][0],
+                         break_line_Coordinate['Section view E-E'][1], break_line_Coordinate['Section view E-E'][2])
+
+        # 關閉所有剖線線所產生之虛線
+        draft.close_all_Generated_Shape()
+
+        # 產生防漏試驗之虛線
+        leakproof_broken_line = {
+            'Front view': [[float(-par.A[i] / 2 + par.FRAME_6_7_width[i] + 50), float(0),
+                            float(-par.A[i] / 2 + 50 + par.FRAME_6_7_width[i]), float(-par.S[i] / 2 - 200)], 0,
+                           'Section view H-H']}
+        draft.Section('Front view', drafting_down_Coordinate_Position['Section view A-A'][0],
+                      drafting_down_Coordinate_Position['Section view A-A'][1], scale,
+                      leakproof_broken_line['Front view'][0], leakproof_broken_line['Front view'][1],
+                      leakproof_broken_line['Front view'][2])
+        Detail_view_leak_broken_line = [float(550), float(-552), float(550), float(-583), float(978), float(-583),
+                                        float(978),
+                                        float(-552)]
+        draft.Define_Polygonal_Cipping_View('Section view H-H', Detail_view_leak_broken_line)
+        draft.selection_Search_delete('Front view', "Name='Callout (Section View).3', all")
+
 if __name__ == "__main__":
     QtCore.QCoreApplication.setAttribute(QtCore.Qt.AA_EnableHighDpiScaling)  # 自適應屏幕分辨率
     app = QtWidgets.QApplication([])
Index: SYEI_stamping_press_system/drafting.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import os\r\nimport win32com.client as win32\r\nimport datetime, time, math\r\nimport main_program as mprog\r\nimport parameter as par\r\n\r\ndraft_area_center_initX = 500\r\ndraft_area_center_initY = 220\r\ndraft_X_clearence = 10\r\ndraft_Y_clearence = 25\r\n# 圖面最大範圍框\r\ndrafting_view_min_Y = 43\r\ndrafting_view_max_Y = 810\r\ndrafting_view_min_X = 20\r\ndrafting_view_max_X = 1250\r\nisometric_view_center_X = 270\r\nisometric_view_center_Y = 600\r\n\r\n\r\ndef drafting_parameter_calculation(width, height, depth, T):  # 電子型錄WHD, 比例\r\n    scale_p = 1\r\n    drafting_area_centerX = draft_area_center_initX  # 前視圖中心\r\n    drafting_area_centerY = draft_area_center_initY\r\n    drafting_isometric_area_centerY = isometric_view_center_Y\r\n    drafting_isometric_area_centerX = (drafting_view_max_X - drafting_view_min_Y) / 2\r\n\r\n    while True:\r\n        # 排除餘數不為 2, 5, 10 的數\r\n        if scale_p % 2 != 0 or scale_p % 5 != 0 or scale_p % 10 != 0:\r\n            scale_p += 1\r\n        scale_tmp = scale_p  # temping original scale\r\n        scale = 1 / scale_p  # proportion convert to ratio\r\n        w_scale = width * scale  # width after scaling\r\n        h_scale = height * scale  # height after scaling\r\n        d_scale = depth * scale\r\n        drafting_area_X_range = w_scale + d_scale * 2 + draft_X_clearence * 6\r\n        drafting_area_Y_range = h_scale + draft_Y_clearence * 2\r\n        drafting_center_Y = (drafting_view_max_Y / 2 + drafting_view_min_Y)\r\n        # ---------isometric view-------------\r\n        drafting_isometric_X_range = w_scale * math.cos(math.radians(45)) * 3 + d_scale * math.cos(\r\n            math.radians(45)) * 2 + scale * 4250 * math.cos(math.radians(45)) + 3500 * scale * math.cos(\r\n            math.radians(45)) + draft_X_clearence * 2  # W多乘2次為增長邊界長度\r\n        drafting_isometric_Y_range = ((1700 + 500) * scale + T * scale + h_scale)  # h為增長邊界範圍(500為上下range)\r\n        # ----------圖面比例位置判斷------------\r\n        # ----------三視圖----------\r\n        if drafting_area_X_range > drafting_view_max_X - drafting_view_min_X:\r\n            scale_p += 1\r\n        elif drafting_area_Y_range > drafting_center_Y - drafting_view_min_Y:\r\n            scale_p += 1\r\n        elif drafting_isometric_X_range > drafting_view_max_X - drafting_view_min_X:\r\n            scale_p += 1\r\n        elif drafting_isometric_Y_range > drafting_view_max_Y - drafting_center_Y:\r\n            scale_p += 1\r\n        else:\r\n            break\r\n    # ------------位置---------------\r\n    # ------------三視圖-------------\r\n    while True:\r\n        drafting_area_X_range = w_scale + d_scale * 2 + draft_X_clearence * 6\r\n        drafting_area_Y_range = h_scale + draft_Y_clearence * 2\r\n        drafting_area_extremum = [drafting_area_centerX - drafting_area_X_range / 2,  # X-min[0]\r\n                                  drafting_area_centerX + drafting_area_X_range / 2,  # X-max[1]\r\n                                  drafting_area_centerY - drafting_area_Y_range / 2 - h_scale * 1 / 3,  # Y-min[2]\r\n                                  drafting_area_centerY + drafting_area_Y_range / 2]  # Y-max[3]\r\n        drafting_center_Y = drafting_view_max_Y / 2 + drafting_view_min_Y\r\n        drafting_root_X = drafting_view_min_X + 5  # 反迴圈框_X\r\n        drafting_root_Y = drafting_view_min_Y + 5\r\n        # ------------Y方向-------------\r\n        if drafting_area_extremum[2] <= drafting_view_min_Y:\r\n            drafting_area_centerY += 1\r\n        elif drafting_area_extremum[2] > drafting_root_Y:\r\n            drafting_area_centerY -= 1\r\n        # ------------X方向-------------\r\n        elif drafting_area_extremum[0] <= drafting_view_min_X:\r\n            drafting_area_centerX += 1\r\n        elif drafting_area_extremum[0] <= drafting_root_X:\r\n            drafting_area_centerX -= 1\r\n        else:\r\n            break\r\n    # ---------isometric position-----------\r\n    while True:\r\n        drafting_isometric_X_range = w_scale * math.cos(math.radians(45)) * 3 + d_scale * math.cos(\r\n            math.radians(45)) * 2 + scale * 4250 * math.cos(math.radians(45)) + 3500 * scale * math.cos(\r\n            math.radians(45)) + draft_X_clearence * 2  # W多乘2次為增長邊界長度\r\n        drafting_isometric_Y_range = ((1700 + 500) * scale + T * scale + h_scale)  # h為增長邊界範圍(500為上下range)\r\n        drafting_isometric_area_extremum = [drafting_isometric_area_centerX - drafting_isometric_X_range / 2,\r\n                                            # X-min[0]\r\n                                            drafting_isometric_area_centerX + drafting_isometric_X_range / 2,\r\n                                            # X-max[1]\r\n                                            drafting_isometric_area_centerY - drafting_isometric_Y_range / 2,\r\n                                            # Y-min[2]\r\n                                            drafting_isometric_area_centerY + drafting_isometric_Y_range / 2]  # Y-max[3]\r\n        drafting_isometric_root_Y_min = drafting_center_Y + 5\r\n        drafting_isometric_root_X_min = drafting_view_min_X + 5\r\n        # ------------Y方向-------------\r\n        if drafting_isometric_area_extremum[2] <= drafting_center_Y:  # 若爆炸圖圖面Y最小值小於中心軸則爆炸圖1圖面中心上移1\r\n            drafting_isometric_area_centerY += 1\r\n        elif drafting_isometric_area_extremum[2] >= drafting_isometric_root_Y_min:  # 若爆炸圖圖面Y最小值大於返回圈框則爆炸圖1圖面中心下移1\r\n            drafting_isometric_area_centerY -= 1\r\n        # ------------X方向-------------\r\n        elif drafting_isometric_area_extremum[0] <= drafting_view_min_X:  # 若爆炸圖圖面X最小值小於中心軸則爆炸圖1圖面中心右移1\r\n            drafting_isometric_area_centerX += 1\r\n        elif drafting_isometric_area_extremum[0] > drafting_isometric_root_X_min:  # 若爆炸圖圖面X最小值小於中心軸則爆炸圖1圖面中心左移1\r\n            drafting_isometric_area_centerX -= 1\r\n        else:\r\n            break\r\n    # 三視圖位置\r\n    drafting_Coordinate_Position = {'Front View': (drafting_area_centerX, drafting_area_centerY),\r\n                                    'Left View': (\r\n                                    drafting_area_centerX - w_scale / 2 - d_scale / 2, drafting_area_centerY),\r\n                                    'Right View': (\r\n                                    drafting_area_centerX + w_scale / 2 + d_scale / 2, drafting_area_centerY)}\r\n    # 等角圖位置\r\n    drafting_isometric_Coordinate_Position = {'exploded_1': (\r\n    drafting_area_centerX + 25 - (drafting_isometric_area_extremum[1] - drafting_isometric_area_extremum[0]) / 5,\r\n    drafting_view_max_Y - (drafting_isometric_area_extremum[3] - drafting_isometric_area_extremum[2]) * 2 / 3),\r\n                                              'exploded_2': (drafting_area_centerX + 50 + (\r\n                                                          drafting_isometric_area_extremum[1] -\r\n                                                          drafting_isometric_area_extremum[0]) / 5,\r\n                                                             drafting_view_max_Y - (\r\n                                                                         drafting_isometric_area_extremum[3] -\r\n                                                                         drafting_isometric_area_extremum[\r\n                                                                             2]) * 2 / 3 - 50)}\r\n    return drafting_Coordinate_Position, drafting_isometric_Coordinate_Position, scale_p\r\n\r\n\r\ndef change_Drawing_scale(value):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingSheet.Scale = float(value)\r\n\r\n\r\ndef exploded_Drawing_1(Type, X_coordinate, Y_coordinate, scale):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Add(\"AutomaticNaming\")\r\n    drawingView.SetViewName(\"Isometric view1\", '', '')  # 更改視圖名稱\r\n    drawingViewGenerativeLinks = drawingView.GenerativeLinks\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    documents = catapp.Documents\r\n    productDocument = documents.Item(str(Type) + \".CATProduct\")\r\n    product = productDocument.Product\r\n    drawingViewGenerativeBehavior.Document = product\r\n    drawingViewGenerativeBehavior.DefineIsometricView(-0.707107, 0.707107, 0, -0.408248, -0.408248, 0.816497)\r\n    drawingView.X = X_coordinate\r\n    drawingView.Y = Y_coordinate\r\n    drawingView.Scale = 1 / scale\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    drawingViewGenerativeBehavior.Update()\r\n    drawingView.Activate()\r\n    selection = productDocument.Selection\r\n    drawingview1 = drawingViews.Item('Isometric view1')\r\n    drawingtexts1 = drawingview1.Texts\r\n    drawingtext1 = drawingtexts1.Item(1)\r\n    drawingtexts1 = drawingtext1.Parent\r\n    selection.Clear()\r\n    selection.Add(drawingtext1)\r\n    selection.Delete()\r\n    selection.Clear()\r\n\r\n\r\ndef exploded_Drawing_2(Type, X_coordinate, Y_coordinate, scale):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Add(\"AutomaticNaming\")\r\n    drawingView.SetViewName(\"Isometric view2\", '', '')  # 更改視圖名稱\r\n    drawingViewGenerativeLinks = drawingView.GenerativeLinks\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    documents = catapp.Documents\r\n    productDocument = documents.Item(str(Type) + \".CATProduct\")\r\n    product = productDocument.Product\r\n    drawingViewGenerativeBehavior.Document = product\r\n    drawingViewGenerativeBehavior.DefineIsometricView(0.707107, -0.707107, 0, 0.408248, 0.408248, 0.816497)\r\n    drawingView.X = X_coordinate\r\n    drawingView.Y = Y_coordinate\r\n    drawingView.Scale = 1 / scale\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    drawingViewGenerativeBehavior.Update()\r\n    drawingView.Activate()\r\n    drawingtexts = drawingView.Texts\r\n    drawingtext = drawingtexts.Item(1)\r\n    drawingtexts = drawingtext.Parent\r\n    selection = productDocument.Selection\r\n    selection.Add(drawingtext)\r\n    selection.Delete()\r\n    selection.Clear()\r\n\r\n\r\ndef Front_View_Drawing(Type, X_coordinate, Y_coordinate, scale):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Add(\"AutomaticNaming\")\r\n    drawingView.SetViewName(\"Front view\", '', '')  # 更改視圖名稱\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    documents = catapp.Documents\r\n    productDocument = documents.Item(str(Type) + \".CATProduct\")\r\n    product = productDocument.Product\r\n    drawingViewGenerativeBehavior.Document = product\r\n    drawingViewGenerativeBehavior.DefineFrontView(0, 1, 0, 0, 0, 1)\r\n    drawingView.X = X_coordinate\r\n    drawingView.Y = Y_coordinate\r\n    drawingView.Scale = 1 / scale\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    drawingViewGenerativeBehavior.Update()\r\n    drawingView.Activate()\r\n    selection = catapp.ActiveDocument.Selection\r\n    selection.Clear()\r\n    selection.Add(catapp.ActiveDocument.sheets.ActiveSheet.Views.ActiveView)\r\n    selection.Search(\"Drafting.Text,sel\")\r\n    selection.Delete()\r\n\r\ndef Left_View_Drawing(Type, X_coordinate, Y_coordinate, scale):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Add(\"AutomaticNaming\")\r\n    drawingView.SetViewName(\"Left view\", '', '')  # 更改視圖名稱\r\n    drawingViewGenerativeLinks = drawingView.GenerativeLinks\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    documents = catapp.Documents\r\n    productDocument = documents.Item(str(Type) + \".CATProduct\")\r\n    product = productDocument.Product\r\n    drawingViewGenerativeBehavior.Document = product\r\n    drawingViewGenerativeBehavior.DefineFrontView(1, 0, 0, 0, 0, 1)\r\n    drawingView.X = X_coordinate\r\n    drawingView.Y = Y_coordinate\r\n    drawingView.Scale = 1 / scale\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    drawingViewGenerativeBehavior.Update()\r\n    drawingView.Activate()\r\n    selection = catapp.ActiveDocument.Selection\r\n    selection.Clear()\r\n    selection.Add(catapp.ActiveDocument.sheets.ActiveSheet.Views.ActiveView)\r\n    selection.Search(\"Drafting.Text,sel\")\r\n    selection.Delete()\r\n\r\n\r\ndef Right_View_Drawing(Type, X_coordinate, Y_coordinate, scale):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Add(\"AutomaticNaming\")\r\n    drawingView.SetViewName(\"Right view\", '', '')  # 更改視圖名稱\r\n    drawingViewGenerativeLinks = drawingView.GenerativeLinks\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    documents = catapp.Documents\r\n    productDocument = documents.Item(str(Type) + \".CATProduct\")\r\n    product = productDocument.Product\r\n    drawingViewGenerativeBehavior.Document = product\r\n    drawingViewGenerativeBehavior.DefineFrontView(-1, 0, 0, 0, 0, 1)\r\n    drawingView.X = X_coordinate\r\n    drawingView.Y = Y_coordinate\r\n    drawingView.Scale = 1 / scale\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    drawingViewGenerativeBehavior.Update()\r\n    drawingView.Activate()\r\n    selection = catapp.ActiveDocument.Selection\r\n    selection.Clear()\r\n    selection.Add(catapp.ActiveDocument.sheets.ActiveSheet.Views.ActiveView)\r\n    selection.Search(\"Drafting.Text,sel\")\r\n    selection.Delete()\r\n\r\n\r\ndef Right_Top_View_Drawing(Type, X_coordinate, Y_coordinate, scale):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Add(\"AutomaticNaming\")\r\n    drawingView.SetViewName(\"Top view\", '', '')  # 更改視圖名稱\r\n    drawingViewGenerativeLinks = drawingView.GenerativeLinks\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    documents = catapp.Documents\r\n    productDocument = documents.Item(str(Type) + \".CATProduct\")\r\n    product = productDocument.Product\r\n    drawingViewGenerativeBehavior.Document = product\r\n    drawingViewGenerativeBehavior.DefineFrontView(-1, 0, 0, 0, -1, 0)\r\n    drawingView.X = X_coordinate\r\n    drawingView.Y = Y_coordinate\r\n    drawingView.Scale = 1 / scale\r\n    drawingViewGenerativeBehavior = drawingView.GenerativeBehavior\r\n    drawingViewGenerativeBehavior.Update()\r\n    drawingView.Activate()\r\n    selection = catapp.ActiveDocument.Selection\r\n    selection.Clear()\r\n    selection.Add(catapp.ActiveDocument.sheets.ActiveSheet.Views.ActiveView)\r\n    selection.Search(\"Drafting.Text,sel\")\r\n    selection.Delete()\r\n\r\ndef coordinate():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    catDrwDoc = catapp.ActiveDocument\r\n    catDrwSel = catDrwDoc.Selection\r\n    catDrwSelLb = catDrwSel\r\n\r\n# 圈碼圖\r\ndef balloons(view, content, circle_position_1, circle_position_2, point_position_1, point_position_2, leader_line_length):\r\n    catapp = win32.Dispatch(\"CATIA.Application\")\r\n    partdoc = catapp.ActiveDocument\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingdocument = catapp.ActiveDocument\r\n    drawingsheets = drawingdocument.Sheets\r\n    drawingsheet = drawingsheets.Item('Sheet.1')\r\n    drawingviews = drawingsheet.Views\r\n    drawingview = drawingviews.Item(view)\r\n    drawingview.Activate()\r\n    # 圈碼內容及位置\r\n    DrawText = drawingview.Texts.Add(content, circle_position_1, circle_position_2)  # (輸入內容, 線段長度X, 線段長度Y)\r\n    DrawText.SetFontName(0, 0, 'Arial Unicode MS (TrueType)')\r\n    DrawText.SetFontSize(0, 0, 10)  # 調整字體位置和大小(x, y, 字體大小)\r\n    DrawText.FrameType = 3  # 圓類型\r\n    # 引線點標註位置\r\n    DrawLeader_DrawTexts_balloons = DrawText.Leaders.Add(point_position_1, point_position_2)  # 圓點位置\r\n    DrawLeader_DrawTexts_balloons.AllAround = 0\r\n    DrawLeader_DrawTexts_balloons.ModifyPoint(0, leader_line_length, 0)  # 選擇引線點 -> (0, 1, 2)並調整座標位置\r\n    DrawLeader_DrawTexts_balloons.HeadSymbol = 20  # 引號標點類型\r\n\r\n# 爆炸圖中心線\r\ndef create_center_line(view_name, x_value_1, y_value_1, x_value_2, y_value_2):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingdocument = catapp.ActiveDocument\r\n    drawingsheets = drawingdocument.Sheets\r\n    drawingsheet = drawingsheets.Item('Sheet.1')\r\n    drawingviews = drawingsheet.Views\r\n    drawingview = drawingviews.Item(view_name)\r\n    drawingview.Activate()\r\n    factory2d = drawingview.Factory2D\r\n    dotted_line = factory2d.CreateLine(x_value_1, y_value_1, x_value_2, y_value_2)\r\n    dotted_line.Name = 'chain_line'\r\n    object = catapp.ActiveDocument.Selection\r\n    object.Search('Name=chain_line,all')\r\n    vis = catapp.ActiveDocument.Selection.VisProperties\r\n    # 更換線段type\r\n    vis.SetRealLineType(2, 0.3)\r\n    vis.SetRealWidth(1, 0.13)\r\n\r\n\r\ndef close_broken_line_block_diagram(view_name):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument1 = catapp.ActiveDocument\r\n    drawingSheets1 = drawingDocument1.Sheets\r\n    drawingSheet1 = drawingSheets1.Item(\"Sheet.1\")\r\n    drawingViews1 = drawingSheet1.Views\r\n    drawingView1 = drawingViews1.Item(view_name)\r\n    drawingView1.FrameVisualization = False\r\n\r\n# 尺寸標註\r\ndef add_dimension_to_view(view_name, item_name, catDimDistance, x_value_1, y_value_1, x_value_2, y_value_2,\r\n                          angle):  # 標註型式, 座標1(X, Y), 座標2(X, Y)\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingdocument = catapp.ActiveDocument\r\n    drawingsheets = drawingdocument.Sheets\r\n    drawingsheet = drawingsheets.Item('Sheet.1')\r\n    drawingviews = drawingsheet.Views\r\n    drawingview = drawingviews.Item(view_name)  # 圖框名稱\r\n    drawingview.Activate()  # 選擇圖框\r\n    factory2d = drawingview.Factory2D\r\n    Point1 = factory2d.CreatePoint(x_value_1, y_value_1)  # 建點\r\n    Point2 = factory2d.CreatePoint(x_value_2, y_value_2)\r\n    iType = catDimDistance  # 標註類型\r\n    geoelem = [Point1, Point2]  # 選擇標註點\r\n    geocoordElem = [x_value_1, y_value_1, x_value_2, y_value_2]  # 座標\r\n    dim = drawingview.Dimensions.Add2(iType, geoelem, geocoordElem, None, angle)  # (標註類型, 選擇標註點, 座標, 參考元素(可空著), 角度)\r\n    dim.Name = item_name\r\n    drawingdim = drawingview.Dimensions.Item(dim.Name)\r\n    if x_value_1 > x_value_2:\r\n        if x_value_1 >= 0:\r\n            x_value = x_value_1 + 300\r\n        else:\r\n            x_value = x_value_1 - 300\r\n    else:\r\n        if x_value_2 >= 0:\r\n            x_value = x_value_2 + 300\r\n        else:\r\n            x_value = x_value_2 - 300\r\n    if y_value_1 > y_value_2:\r\n        if y_value_1 >= 0:\r\n            y_value = y_value_1 + 300\r\n        else:\r\n            y_value = y_value_1 - 300\r\n    else:\r\n        if y_value_2 >= 0:\r\n            y_value = y_value_2 + 300\r\n        else:\r\n            y_value = y_value_2 - 300\r\n    drawingdim.MoveValue(x_value, y_value, 2, 0)  # 標註偏移(X, Y, 選擇偏移部位, 角度尺寸)\r\n\r\n\r\ndef symbol_of_weld(view, WeldingSymbol, lead_X, lead_Y, WeldingTail):  # 焊接符號\r\n    catapp = win32.Dispatch(\"CATIA.Application\")\r\n    partdoc = catapp.ActiveDocument\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingdocument = catapp.ActiveDocument\r\n    drawingsheets = drawingdocument.Sheets\r\n    drawingsheet = drawingsheets.Item('Sheet.1')\r\n    drawingviews = drawingsheet.Views\r\n    drawingview = drawingviews.Item(view)\r\n    MyWelding = drawingview.Weldings.Add(WeldingSymbol, lead_X, lead_Y)  # 引線標註點位置(引線符號, 座標X, 座標Y)\r\n    # 基線位置\r\n    # 基線計算位置時要注意需呈現為60度\r\n    if lead_X >= 0:\r\n        MyWelding.X = lead_X + 100 * math.cos(math.radians(60))\r\n        MyWelding.angle = 0\r\n    else:\r\n        MyWelding.X = lead_X - 100 * math.cos(math.radians(60))\r\n        MyWelding.angle = 180\r\n    if lead_Y >= 0:\r\n        MyWelding.Y = lead_Y + 100 * math.sin(math.radians(60))\r\n    else:\r\n        MyWelding.Y = lead_Y - 100 * math.sin(math.radians(60))\r\n    MyWelding.WeldingTail = WeldingTail  # 是否開啟尾叉 0 or 1\r\n\r\n    for i in range(1, 14):\r\n        print(i)\r\n        drawingWelding1 = MyWelding\r\n        # drawingWelding1 = drawingWeldings1.Item('Welding Symbol.1')\r\n        catWeldingFieldOne = i\r\n        textRange1 = drawingWelding1.GetTextRange(catWeldingFieldOne)\r\n        char1 = textRange1.Text\r\n        textRange1.Text = i\r\n        TextProperties = drawingWelding1.TextProperties\r\n        TextProperties.Update()\r\n\r\n\r\ndef background():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingdocument = catapp.ActiveDocument\r\n    drawingsheets = drawingdocument.Sheets\r\n    drawingsheet = drawingsheets.Item('Sheet.1')\r\n    drawingview = drawingsheet.Views.Item('Background View').Activate()\r\n\r\n\r\ndef drafting_welding_view_parameter_calculation(width, height, depth, S, Z, T):  # 電子型錄WHD, 比例\r\n    scale_p = 1\r\n    drafting_area_centerX = par.drafting_front_area_centerX  # 上:上視圖中心 & 下:前視圖中心\r\n    drafting_down_area_centerY = par.drafting_down_area_centerY\r\n    drafting_up_area_centerY = par.drafting_up_area_centerY\r\n\r\n    while True:\r\n        # 排除餘數不為 2, 5, 10 的數\r\n        if scale_p % 2 != 0 or scale_p % 5 != 0 or scale_p % 10 != 0:\r\n            scale_p += 1\r\n        scale = 1 / scale_p  # proportion convert to ratio\r\n        w_scale = width * scale  # width after scaling\r\n        h_scale = height * scale  # height after scaling\r\n        d_scale = depth * scale\r\n        S_scale = S * scale\r\n        Z_T_scale = (Z - T) * scale\r\n        T_scale = T * scale\r\n        # ------------下圖總範圍-------------\r\n        drafting_down_area_X_range = w_scale * 2 + d_scale * 2 + par.draft_X_clearence * 5\r\n        drafting_down_area_Y_range = h_scale + par.draft_Y_clearence * 2\r\n        drafting_up_max_range_center_Y = (821 - par.drafting_view_min_X) * 2 / 3 + par.drafting_view_min_Y\r\n        # ------------上圖總範圍-------------\r\n        drafting_up_area_X_range = w_scale * 2 + d_scale * 2 + par.draft_X_clearence * 5\r\n        drafting_up_area_Y_range = w_scale + par.draft_Y_clearence * 2\r\n        # ----------圖面比例判斷------------\r\n        # ----------下圖----------\r\n        if drafting_down_area_X_range > par.drafting_view_max_X - par.drafting_view_min_X:\r\n            scale_p += 1\r\n        elif drafting_down_area_Y_range > drafting_up_max_range_center_Y - par.drafting_view_min_Y:\r\n            scale_p += 1\r\n        # ----------上圖----------\r\n        elif drafting_up_area_X_range > par.drafting_view_max_X - par.drafting_view_min_X:\r\n            scale_p += 1\r\n        elif drafting_up_area_Y_range > par.drafting_view_max_Y - drafting_up_max_range_center_Y:\r\n            scale_p += 1\r\n        else:\r\n            break\r\n    # ------------下圖位置判斷-------------\r\n    while True:\r\n        drafting_area_X_left_range = w_scale * 1.5 + par.draft_X_clearence * 5\r\n        drafting_area_X_right_range = w_scale + d_scale * 1.5 + par.draft_X_clearence * 10\r\n        drafting_down_area_extremum = [drafting_area_centerX - drafting_area_X_left_range,  # X-min[0]\r\n                                       drafting_area_centerX + drafting_area_X_right_range]  # X-max[1]\r\n        drafting_root_X = par.drafting_view_min_X + 5  # 反迴圈框_X\r\n        # ------------X方向-------------\r\n        if drafting_down_area_extremum[0] <= par.drafting_view_min_X:\r\n            drafting_area_centerX += 1\r\n        elif drafting_down_area_extremum[0] <= drafting_root_X:\r\n            drafting_area_centerX -= 1\r\n        else:\r\n            break\r\n    # ------------上圖位置判斷--------------註:X位置共用\r\n    while True:\r\n        drafting_up_area_Y_range = w_scale + par.draft_Y_clearence * 2\r\n        drafting_up_area_extremum = [drafting_up_area_centerY - drafting_up_area_Y_range / 2,  # Y-min[0]\r\n                                     drafting_up_area_centerY + drafting_up_area_Y_range / 2]  # Y-max[1]\r\n        drafting_up_root_Y_min = drafting_up_max_range_center_Y + 5\r\n        # ------------Y方向-------------\r\n        if drafting_up_area_extremum[0] >= drafting_up_root_Y_min:\r\n            drafting_up_area_centerY -= 1\r\n        elif drafting_up_area_extremum[0] <= drafting_up_max_range_center_Y:  # 若爆炸圖圖面Y最小值小於中心軸則爆炸圖1圖面中心上移1\r\n            drafting_up_area_centerY += 1\r\n        else:\r\n            break\r\n    # 下圖位置\r\n    drafting_down_Coordinate_Position = {\r\n        'Right View': (drafting_area_centerX - drafting_area_X_left_range, drafting_down_area_centerY),\r\n        'Front View': (drafting_area_centerX, drafting_down_area_centerY),\r\n        'Section view A-A': (drafting_area_centerX + drafting_area_X_left_range + (d_scale - w_scale) / 5, drafting_down_area_centerY),\r\n        'Section view B-B': (drafting_area_centerX + drafting_area_X_left_range * 2 + (d_scale - w_scale) / 5, drafting_down_area_centerY),\r\n        'Section view F-F': (drafting_area_centerX + drafting_area_X_left_range * 2 + (d_scale - w_scale) / 5 - w_scale / 3, drafting_down_area_centerY - h_scale / 3),\r\n        'Section view G-G': (drafting_area_centerX + drafting_area_X_left_range * 2 + (d_scale - w_scale) / 5 + w_scale / 3, drafting_down_area_centerY - h_scale / 3)}\r\n    # 上圖位置\r\n    drafting_up_Coordinate_Position = {\r\n        'Section view D-D': (drafting_area_centerX - drafting_area_X_left_range, drafting_up_area_centerY),\r\n        'Top View': (drafting_area_centerX, drafting_up_area_centerY),\r\n        'Section view C-C': (drafting_area_centerX + drafting_area_X_left_range + (d_scale - w_scale) / 5, drafting_up_area_centerY),\r\n        'Section view E-E': (drafting_area_centerX + drafting_area_X_left_range * 2 + (d_scale - w_scale) * 1 / 2, drafting_up_area_centerY)}\r\n    return drafting_down_Coordinate_Position, drafting_up_Coordinate_Position, scale_p\r\n\r\n# 剖面圖\r\ndef Section(view_name, Coordinate_X, Coordinate_Y, Scale, Coordinate, change_direction, new_create_view_name):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument1 = catapp.ActiveDocument\r\n    drawingSheets1 = drawingDocument1.Sheets\r\n    drawingSheet1 = drawingSheets1.Item(\"Sheet.1\")\r\n    drawingViews1 = drawingSheet1.Views\r\n    drawingView1 = drawingViews1.Item(view_name)  # 圖框名稱\r\n    drawingView1.Activate()\r\n    drawingSheets1 = drawingDocument1.Sheets\r\n    drawingViews1 = drawingSheet1.Views\r\n    drawingView1 = drawingViews1.ActiveView\r\n    drawingViewGenerativeBehavior1 = drawingView1.GenerativeBehavior\r\n    drawingView2 = drawingViews1.Add(\"AutomaticNaming\")\r\n    drawingViewGenerativeBehavior2 = drawingView2.GenerativeBehavior\r\n    drawingView2.X = Coordinate_X\r\n    drawingView2.Y = Coordinate_Y\r\n    drawingView2.Scale = 1 / Scale\r\n    drawingView2.Angle = 0\r\n    SectionProfile =Coordinate\r\n    drawingViewGenerativeBehavior2Variant = drawingViewGenerativeBehavior2\r\n    drawingViewGenerativeBehavior2Variant.DefineSectionView(SectionProfile, \"SectionView\", \"Offset\", change_direction, drawingViewGenerativeBehavior1)\r\n    drawingViewGenerativeLinks1 = drawingView2.GenerativeLinks\r\n    drawingViewGenerativeLinks2 = drawingView1.GenerativeLinks\r\n    drawingViewGenerativeLinks2.CopyLinksTo(drawingViewGenerativeLinks1)\r\n    drawingViewGenerativeBehavior2 = drawingView2.GenerativeBehavior\r\n    drawingViewGenerativeBehavior2.Update()\r\n    drawingView2.ReferenceView = drawingView1\r\n    drawingView2.AlignedWithReferenceView()\r\n    # 選定新投影圖面刪除文字方塊\r\n    drawingDocument1 = catapp.ActiveDocument\r\n    drawingSheets1 = drawingDocument1.Sheets\r\n    drawingSheet1 = drawingSheets1.Item(\"Sheet.1\")\r\n    drawingViews1 = drawingSheet1.Views\r\n    drawingView1 = drawingViews1.Item(new_create_view_name)  # 圖框名稱\r\n    drawingView1.Activate()\r\n    selection = catapp.ActiveDocument.Selection\r\n    selection.Clear()\r\n    selection.Add(catapp.ActiveDocument.sheets.ActiveSheet.Views.ActiveView)\r\n    selection.Search(\"Drafting.Text,sel\")\r\n    selection.Delete()\r\n\r\ndef Define_Polygonal_Detail_View(view_name, Coordinate, Coordinate_X, Coordinate_Y):  # 留下框選範圍圖面\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Item(view_name)  # 圖框名稱\r\n    drawingView.Activate()\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.ActiveSheet\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.ActiveView\r\n    drawingViewGenerativeBehavior1 = drawingView.GenerativeBehavior\r\n    SectionProfile = Coordinate  # 給定框選範圍點座標\r\n    drawingViewGenerativeBehavior1Variant = drawingViewGenerativeBehavior1\r\n    drawingViewGenerativeBehavior1Variant.DefinePolygonalDetailView(SectionProfile[0:], drawingViewGenerativeBehavior1)\r\n    drawingViewGenerativeBehavior1 = drawingView.GenerativeBehavior\r\n    drawingViewGenerativeBehavior1.ForceUpdate()\r\n    # 重新設定圖面座標\r\n    # try:\r\n    #     drawingView.X = Coordinate_X\r\n    #     drawingView.Y = Coordinate_Y\r\n    # except:\r\n    #     pass\r\n\r\ndef break_line(view_name, Coordinate, X_direction, Y_direction):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Item(view_name)  # 圖框名稱\r\n    drawingView.Activate()\r\n    drawingDocument1 = catapp.ActiveDocument\r\n    drawingSheets1 = drawingDocument1.Sheets\r\n    drawingSheet1 = drawingSheets1.ActiveSheet\r\n    drawingViews1 = drawingSheet1.Views\r\n    drawingView1 = drawingViews1.ActiveView\r\n    drawingViewGenerativeBehavior1 = drawingView1.GenerativeBehavior\r\n    SectionProfile = Coordinate  # 選擇要框選省略之範圍\r\n    drawingViewGenerativeBehavior1Variant = drawingViewGenerativeBehavior1\r\n    drawingViewGenerativeBehavior1Variant.DefineBrokenView(SectionProfile[0:], X_direction, Y_direction)\r\n    # drawingViewGenerativeBehavior1Variant.SetRealLineType(8, 0.2)\r\n    # drawingViewGenerativeBehavior1Variant.visProperties1.SetRealWidth(2, 0.25)\r\n\r\ndef close_all_Generated_Shape():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    selection = catapp.ActiveDocument.Selection\r\n    selection.Clear()\r\n    selection.Add(catapp.ActiveDocument.sheets.ActiveSheet.Views.ActiveView)\r\n    selection.Search(\"Drafting.Generated Shape,all\")\r\n    selection.Delete()\r\n\r\ndef close_selection_text():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    selection = catapp.ActiveDocument.Selection\r\n    selection.Clear()\r\n    selection.Add(catapp.ActiveDocument.sheets.ActiveSheet.Views.ActiveView)\r\n    selection.Search(\"Drafting.text, sel\")\r\n    selection.Delete()\r\n\r\ndef move_view_Position(view_name, X_Position, Y_Position):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Item(view_name)  # 圖框名稱\r\n    drawingView.Activate()\r\n    drawingView.X = X_Position\r\n    drawingView.Y = Y_Position\r\n\r\ndef Define_Polygonal_Cipping_View(view_name, Coordinate, hide_show):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Item(view_name)  # 圖框名稱\r\n    drawingView.Activate()\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.ActiveSheet\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.ActiveView\r\n    drawingViewGenerativeBehavior1 = drawingView.GenerativeBehavior\r\n    SectionProfile = Coordinate  # 給定框選範圍點座標\r\n    drawingViewGenerativeBehavior1Variant = drawingViewGenerativeBehavior1\r\n    drawingViewGenerativeBehavior1Variant.DefinePolygonalClippingView(SectionProfile[0:])\r\n    drawingViewGenerativeBehavior1 = drawingView.GenerativeBehavior\r\n    drawingViewGenerativeBehavior1.ForceUpdate()\r\n\r\n# 指定type種類全部刪除\r\n# 使用方法:\"⌈輸入type⌋',all\"\r\n# 指定元素名稱並刪除\r\n# 使用方法:\"Name='⌈輸入名稱⌋',all\"\r\ndef selection_Search_delete(view_name, selection_name):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    drawingDocument = catapp.ActiveDocument\r\n    drawingSheets = drawingDocument.Sheets\r\n    drawingSheet = drawingSheets.Item(\"Sheet.1\")\r\n    drawingViews = drawingSheet.Views\r\n    drawingView = drawingViews.Item(view_name)  # 圖框名稱\r\n    drawingView.Activate()\r\n    selection = catapp.ActiveDocument.Selection\r\n    selection.Clear()\r\n    selection.Add(catapp.ActiveDocument.sheets.ActiveSheet.Views.ActiveView)\r\n    selection.Search(selection_name)\r\n    selection.Delete()
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SYEI_stamping_press_system/drafting.py b/SYEI_stamping_press_system/drafting.py
--- a/SYEI_stamping_press_system/drafting.py	(revision 9b03e8114d34ddad78b2ae1878b096aad22932e2)
+++ b/SYEI_stamping_press_system/drafting.py	(date 1676258885248)
@@ -402,7 +402,7 @@
     drawingdim.MoveValue(x_value, y_value, 2, 0)  # 標註偏移(X, Y, 選擇偏移部位, 角度尺寸)
 
 
-def symbol_of_weld(view, WeldingSymbol, lead_X, lead_Y, WeldingTail):  # 焊接符號
+def symbol_of_weld(view, WeldingSymbol, lead_X, lead_Y, WeldingTail, parameter):  # 焊接符號
     catapp = win32.Dispatch("CATIA.Application")
     partdoc = catapp.ActiveDocument
     catapp = win32.Dispatch('CATIA.Application')
@@ -418,24 +418,26 @@
         MyWelding.X = lead_X + 100 * math.cos(math.radians(60))
         MyWelding.angle = 0
     else:
-        MyWelding.X = lead_X - 100 * math.cos(math.radians(60))
-        MyWelding.angle = 180
+        MyWelding.X = lead_X - 300
+        MyWelding.angle = 0
     if lead_Y >= 0:
-        MyWelding.Y = lead_Y + 100 * math.sin(math.radians(60))
+        MyWelding.Y = lead_Y + 300 * math.cos(math.radians(60)) / math.sin(math.radians(60))
     else:
-        MyWelding.Y = lead_Y - 100 * math.sin(math.radians(60))
+        MyWelding.Y = lead_Y - 300 * math.cos(math.radians(60)) / math.sin(math.radians(60))
     MyWelding.WeldingTail = WeldingTail  # 是否開啟尾叉 0 or 1
 
     for i in range(1, 14):
-        print(i)
-        drawingWelding1 = MyWelding
-        # drawingWelding1 = drawingWeldings1.Item('Welding Symbol.1')
-        catWeldingFieldOne = i
-        textRange1 = drawingWelding1.GetTextRange(catWeldingFieldOne)
-        char1 = textRange1.Text
-        textRange1.Text = i
-        TextProperties = drawingWelding1.TextProperties
-        TextProperties.Update()
+        try:
+            drawingWelding1 = MyWelding
+            # drawingWelding1 = drawingWeldings1.Item('Welding Symbol.1')
+            catWeldingFieldOne = i
+            textRange1 = drawingWelding1.GetTextRange(catWeldingFieldOne)
+            char1 = textRange1.Text
+            textRange1.Text = parameter[i]
+            TextProperties = drawingWelding1.TextProperties
+            TextProperties.Update()
+        except:
+            pass
 
 
 def background():
@@ -641,7 +643,7 @@
     drawingView.X = X_Position
     drawingView.Y = Y_Position
 
-def Define_Polygonal_Cipping_View(view_name, Coordinate, hide_show):
+def Define_Polygonal_Cipping_View(view_name, Coordinate):
     catapp = win32.Dispatch('CATIA.Application')
     drawingDocument = catapp.ActiveDocument
     drawingSheets = drawingDocument.Sheets
Index: SYEI_stamping_press_system/file_path.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import os\r\n#檔案路徑\r\nsystem_root =os.path.dirname(os.path.realpath(__file__))\r\npart = \"\\\\stamping_press\"\r\nExploded_Views = \"\\\\Exploded_Views.CATDrawing\"\r\ndetail_drawing =\"\\\\detail_drawing.CATDrawing\"
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SYEI_stamping_press_system/file_path.py b/SYEI_stamping_press_system/file_path.py
--- a/SYEI_stamping_press_system/file_path.py	(revision 9b03e8114d34ddad78b2ae1878b096aad22932e2)
+++ b/SYEI_stamping_press_system/file_path.py	(date 1676253005272)
@@ -3,4 +3,5 @@
 system_root =os.path.dirname(os.path.realpath(__file__))
 part = "\\stamping_press"
 Exploded_Views = "\\Exploded_Views.CATDrawing"
-detail_drawing ="\\detail_drawing.CATDrawing"
\ No newline at end of file
+detail_drawing ="\\detail_drawing.CATDrawing"
+Welding_diagram = "\\Welding_diagram.CATDrawing"
\ No newline at end of file
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"16196f2d-2bed-4919-b6e6-decc4073d892\" name=\"Changes\" comment=\"py檔更換位置\">\r\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/SYEI_stamping_press_system/123.py\" beforeDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/SYEI_stamping_press_system/FRAME_ASSEMBLY.py\" beforeDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/SYEI_stamping_press_system/PY.py\" beforeDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/SYEI_stamping_press_system/TEST.py\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/SYEI_stamping_press_system/TEST.py\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/SYEI_stamping_press_system/drafting.py\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/SYEI_stamping_press_system/drafting.py\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/SYEI_stamping_press_system/parameter.py\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/SYEI_stamping_press_system/parameter.py\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"Python Script\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"PREVIOUS_COMMIT_AUTHORS\">\r\n      <list>\r\n        <option value=\"USER &lt;c109104260@nkust.edu.tw&gt;\" />\r\n      </list>\r\n    </option>\r\n    <option name=\"PUSH_AUTO_UPDATE\" value=\"true\" />\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n    <option name=\"RESET_MODE\" value=\"MIXED\" />\r\n  </component>\r\n  <component name=\"GitSEFilterConfiguration\">\r\n    <file-type-list>\r\n      <filtered-out-file-type name=\"LOCAL_BRANCH\" />\r\n      <filtered-out-file-type name=\"REMOTE_BRANCH\" />\r\n      <filtered-out-file-type name=\"TAG\" />\r\n      <filtered-out-file-type name=\"COMMIT_BY_MESSAGE\" />\r\n    </file-type-list>\r\n  </component>\r\n  <component name=\"ProjectId\" id=\"2HNiUWrGHo44xE9O4z5nXSKlf4K\" />\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">\r\n    <property name=\"RunOnceActivity.OpenProjectViewOnStart\" value=\"true\" />\r\n    <property name=\"RunOnceActivity.ShowReadmeOnStart\" value=\"true\" />\r\n    <property name=\"last_opened_file_path\" value=\"$PROJECT_DIR$\" />\r\n    <property name=\"settings.editor.selected.configurable\" value=\"com.jetbrains.python.configuration.PyActiveSdkModuleConfigurable\" />\r\n  </component>\r\n  <component name=\"RecentsManager\">\r\n    <key name=\"CopyFile.RECENT_KEYS\">\r\n      <recent name=\"C:\\Users\\User\\PycharmProjects\\stamping_press\" />\r\n    </key>\r\n  </component>\r\n  <component name=\"RunManager\" selected=\"Python.TEST (1)\">\r\n    <configuration name=\"PY\" type=\"PythonConfigurationType\" factoryName=\"Python\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <module name=\"Stamping press\" />\r\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\r\n      <option name=\"PARENT_ENVS\" value=\"true\" />\r\n      <envs>\r\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\r\n      </envs>\r\n      <option name=\"SDK_HOME\" value=\"\" />\r\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$\" />\r\n      <option name=\"IS_MODULE_SDK\" value=\"true\" />\r\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\r\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\r\n      <option name=\"SCRIPT_NAME\" value=\"$PROJECT_DIR$/PY.py\" />\r\n      <option name=\"PARAMETERS\" value=\"\" />\r\n      <option name=\"SHOW_COMMAND_LINE\" value=\"false\" />\r\n      <option name=\"EMULATE_TERMINAL\" value=\"false\" />\r\n      <option name=\"MODULE_MODE\" value=\"false\" />\r\n      <option name=\"REDIRECT_INPUT\" value=\"false\" />\r\n      <option name=\"INPUT_FILE\" value=\"\" />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <configuration name=\"TEST (1)\" type=\"PythonConfigurationType\" factoryName=\"Python\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <module name=\"Stamping press\" />\r\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\r\n      <option name=\"PARENT_ENVS\" value=\"true\" />\r\n      <envs>\r\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\r\n      </envs>\r\n      <option name=\"SDK_HOME\" value=\"\" />\r\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$/SYEI_stamping_press_system\" />\r\n      <option name=\"IS_MODULE_SDK\" value=\"true\" />\r\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\r\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\r\n      <option name=\"SCRIPT_NAME\" value=\"$PROJECT_DIR$/SYEI_stamping_press_system/TEST.py\" />\r\n      <option name=\"PARAMETERS\" value=\"\" />\r\n      <option name=\"SHOW_COMMAND_LINE\" value=\"false\" />\r\n      <option name=\"EMULATE_TERMINAL\" value=\"false\" />\r\n      <option name=\"MODULE_MODE\" value=\"false\" />\r\n      <option name=\"REDIRECT_INPUT\" value=\"false\" />\r\n      <option name=\"INPUT_FILE\" value=\"\" />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <configuration name=\"TEST\" type=\"PythonConfigurationType\" factoryName=\"Python\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <module name=\"Stamping press\" />\r\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\r\n      <option name=\"PARENT_ENVS\" value=\"true\" />\r\n      <envs>\r\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\r\n      </envs>\r\n      <option name=\"SDK_HOME\" value=\"\" />\r\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$\" />\r\n      <option name=\"IS_MODULE_SDK\" value=\"true\" />\r\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\r\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\r\n      <option name=\"SCRIPT_NAME\" value=\"$PROJECT_DIR$/TEST.py\" />\r\n      <option name=\"PARAMETERS\" value=\"\" />\r\n      <option name=\"SHOW_COMMAND_LINE\" value=\"false\" />\r\n      <option name=\"EMULATE_TERMINAL\" value=\"false\" />\r\n      <option name=\"MODULE_MODE\" value=\"false\" />\r\n      <option name=\"REDIRECT_INPUT\" value=\"false\" />\r\n      <option name=\"INPUT_FILE\" value=\"\" />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <configuration name=\"drafting_part\" type=\"PythonConfigurationType\" factoryName=\"Python\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <module name=\"Stamping press\" />\r\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\r\n      <option name=\"PARENT_ENVS\" value=\"true\" />\r\n      <envs>\r\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\r\n      </envs>\r\n      <option name=\"SDK_HOME\" value=\"\" />\r\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$/SYEI_stamping_press_system\" />\r\n      <option name=\"IS_MODULE_SDK\" value=\"true\" />\r\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\r\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\r\n      <option name=\"SCRIPT_NAME\" value=\"$PROJECT_DIR$/SYEI_stamping_press_system/drafting_part.py\" />\r\n      <option name=\"PARAMETERS\" value=\"\" />\r\n      <option name=\"SHOW_COMMAND_LINE\" value=\"false\" />\r\n      <option name=\"EMULATE_TERMINAL\" value=\"false\" />\r\n      <option name=\"MODULE_MODE\" value=\"false\" />\r\n      <option name=\"REDIRECT_INPUT\" value=\"false\" />\r\n      <option name=\"INPUT_FILE\" value=\"\" />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <configuration name=\"main_GUI\" type=\"PythonConfigurationType\" factoryName=\"Python\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <module name=\"Stamping press\" />\r\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\r\n      <option name=\"PARENT_ENVS\" value=\"true\" />\r\n      <envs>\r\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\r\n      </envs>\r\n      <option name=\"SDK_HOME\" value=\"\" />\r\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$/SYEI_stamping_press_system\" />\r\n      <option name=\"IS_MODULE_SDK\" value=\"true\" />\r\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\r\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\r\n      <option name=\"SCRIPT_NAME\" value=\"$PROJECT_DIR$/SYEI_stamping_press_system/main_GUI.py\" />\r\n      <option name=\"PARAMETERS\" value=\"\" />\r\n      <option name=\"SHOW_COMMAND_LINE\" value=\"false\" />\r\n      <option name=\"EMULATE_TERMINAL\" value=\"false\" />\r\n      <option name=\"MODULE_MODE\" value=\"false\" />\r\n      <option name=\"REDIRECT_INPUT\" value=\"false\" />\r\n      <option name=\"INPUT_FILE\" value=\"\" />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <recent_temporary>\r\n      <list>\r\n        <item itemvalue=\"Python.TEST (1)\" />\r\n        <item itemvalue=\"Python.main_GUI\" />\r\n        <item itemvalue=\"Python.drafting_part\" />\r\n        <item itemvalue=\"Python.TEST\" />\r\n        <item itemvalue=\"Python.PY\" />\r\n      </list>\r\n    </recent_temporary>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"16196f2d-2bed-4919-b6e6-decc4073d892\" name=\"Changes\" comment=\"\" />\r\n      <created>1668131959961</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1668131959961</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00010\" summary=\"新增test機架零件變數變換和機架組和更新\">\r\n      <created>1668516189353</created>\r\n      <option name=\"number\" value=\"00010\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00010\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668516189353</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00011\" summary=\"新增test機架零件變數變換和機架組和更新\">\r\n      <created>1668519506744</created>\r\n      <option name=\"number\" value=\"00011\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00011\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668519506744</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00012\" summary=\"新增test機架零件變數變換和機架組和更新\">\r\n      <created>1668520170071</created>\r\n      <option name=\"number\" value=\"00012\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00012\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668520170071</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00013\" summary=\"新增test機架零件變數變換和機架組和更新\">\r\n      <created>1668520455726</created>\r\n      <option name=\"number\" value=\"00013\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00013\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668520455726</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00014\" summary=\"新增test1機架組合和組合檔結合\">\r\n      <created>1668564901994</created>\r\n      <option name=\"number\" value=\"00014\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00014\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668564901994</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00015\" summary=\"新增test1機架組合和組合檔結合\">\r\n      <created>1668564917977</created>\r\n      <option name=\"number\" value=\"00015\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00015\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668564917977</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00016\" summary=\"更改檔名&#10;新增:沖床測試檔\">\r\n      <created>1668605946628</created>\r\n      <option name=\"number\" value=\"00016\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00016\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668605946628</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00017\" summary=\"新增...\">\r\n      <created>1668611116553</created>\r\n      <option name=\"number\" value=\"00017\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00017\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668611116553</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00018\" summary=\"FRAME_Assembly_change更改部分缺失結合尺寸及結合方式\">\r\n      <created>1668698222569</created>\r\n      <option name=\"number\" value=\"00018\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00018\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668698222569</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00019\" summary=\"新增:標準件結合\">\r\n      <created>1668781374862</created>\r\n      <option name=\"number\" value=\"00019\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00019\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668781374862</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00020\" summary=\"新增:標準件結合\">\r\n      <created>1668843984942</created>\r\n      <option name=\"number\" value=\"00020\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00020\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668843984942</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00021\" summary=\"新增:平板與標準件連結\">\r\n      <created>1668844200933</created>\r\n      <option name=\"number\" value=\"00021\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00021\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668844200933</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00022\" summary=\"新增:平板與標準件連結\">\r\n      <created>1668860563635</created>\r\n      <option name=\"number\" value=\"00022\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00022\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668860563635</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00023\" summary=\"新增:變數及結合判斷式\">\r\n      <created>1668860593088</created>\r\n      <option name=\"number\" value=\"00023\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00023\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668860593088</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00024\" summary=\"新增:變數與結合判斷式\">\r\n      <created>1668861100744</created>\r\n      <option name=\"number\" value=\"00024\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00024\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668861100744</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00025\" summary=\"修改部分YZ尺寸距離\">\r\n      <created>1668870166204</created>\r\n      <option name=\"number\" value=\"00025\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00025\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668870166204</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00026\" summary=\"80~250噸數OK\">\r\n      <created>1668942377027</created>\r\n      <option name=\"number\" value=\"00026\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00026\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668942377027</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00027\" summary=\"修改結合尺寸與判斷式\">\r\n      <created>1668947649149</created>\r\n      <option name=\"number\" value=\"00027\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00027\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668947649149</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00028\" summary=\"修改標準件判斷條件及新增噸數300尺寸\">\r\n      <created>1669042645660</created>\r\n      <option name=\"number\" value=\"00028\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00028\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1669042645660</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00029\" summary=\"修改氣壓缸尺寸\">\r\n      <created>1669043614548</created>\r\n      <option name=\"number\" value=\"00029\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00029\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1669043614548</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00030\" summary=\"修改FRAME32結合距離及尺寸、氣壓缸結合距離\">\r\n      <created>1669107668327</created>\r\n      <option name=\"number\" value=\"00030\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00030\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1669107668327</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00031\" summary=\"移除行程部分\">\r\n      <created>1669115571073</created>\r\n      <option name=\"number\" value=\"00031\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00031\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1669115571073</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00032\" summary=\"SP移除閉合部分&#10;main_GUI新增判斷條件\">\r\n      <created>1669119855900</created>\r\n      <option name=\"number\" value=\"00032\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00032\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1669119855900</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00033\" summary=\"新增結合零件&#10;新增Product存檔\">\r\n      <created>1670073006067</created>\r\n      <option name=\"number\" value=\"00033\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00033\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1670073006067</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00034\" summary=\"新增標準件偏移結合\">\r\n      <created>1670086312963</created>\r\n      <option name=\"number\" value=\"00034\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00034\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1670086312963</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00035\" summary=\"新增:爆炸圖尺寸更改\">\r\n      <created>1670253116158</created>\r\n      <option name=\"number\" value=\"00035\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00035\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1670253116158</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00036\" summary=\"Merge remote-tracking branch 'origin/master'&#10;&#10;# Conflicts:&#10;#&#9;123.py&#10;#&#9;GUI/main_GUI.py\">\r\n      <created>1670318199355</created>\r\n      <option name=\"number\" value=\"00036\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00036\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1670318199355</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00037\" summary=\"新增:爆炸圖圖面\">\r\n      <created>1670318251316</created>\r\n      <option name=\"number\" value=\"00037\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00037\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1670318251316</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00038\" summary=\"新增:爆炸圖圖面\">\r\n      <created>1670318256390</created>\r\n      <option name=\"number\" value=\"00038\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00038\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1670318256390</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00039\" summary=\"新增:比例判別, 生成2D視圖\">\r\n      <created>1670337064813</created>\r\n      <option name=\"number\" value=\"00039\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00039\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1670337064813</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00040\" summary=\"比例調整及判斷\">\r\n      <created>1670573601274</created>\r\n      <option name=\"number\" value=\"00040\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00040\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1670573601274</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00041\" summary=\"完成爆炸圖下半部比例位置自動調整\">\r\n      <created>1670577732225</created>\r\n      <option name=\"number\" value=\"00041\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00041\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1670577732225</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00042\" summary=\"更改主檔爆炸圖下圖\">\r\n      <created>1670918566295</created>\r\n      <option name=\"number\" value=\"00042\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00042\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1670918566295</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00043\" summary=\"完成爆炸圖比例位置偏移\">\r\n      <created>1671034419443</created>\r\n      <option name=\"number\" value=\"00043\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00043\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1671034419443</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00044\" summary=\"修正爆炸圖比例偏移\">\r\n      <created>1671168366685</created>\r\n      <option name=\"number\" value=\"00044\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00044\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1671168366685</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00045\" summary=\"建立及測試圈碼圖&#10;(Y方向卡關)\">\r\n      <created>1671273349379</created>\r\n      <option name=\"number\" value=\"00045\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00045\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1671273349379</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00046\" summary=\"建立及測試圈碼圖&#10;(Y方向卡關)\">\r\n      <created>1671273358578</created>\r\n      <option name=\"number\" value=\"00046\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00046\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1671273358578</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00047\" summary=\"完成零件6圈碼圖建立\">\r\n      <created>1671354767706</created>\r\n      <option name=\"number\" value=\"00047\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00047\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1671354767706</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00048\" summary=\"修改爆炸圖偏移二變數&#10;新增更改視圖名稱\">\r\n      <created>1671878126103</created>\r\n      <option name=\"number\" value=\"00048\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00048\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1671878126103</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00049\" summary=\"N1及drafting_test更新\">\r\n      <created>1672144632891</created>\r\n      <option name=\"number\" value=\"00049\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00049\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1672144632891</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00050\" summary=\"N1及drafting_test更新\">\r\n      <created>1672144785065</created>\r\n      <option name=\"number\" value=\"00050\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00050\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1672144785065</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00051\" summary=\"N1及drafting_test更新\">\r\n      <created>1672153488883</created>\r\n      <option name=\"number\" value=\"00051\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00051\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1672153488883</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00052\" summary=\"N1及N_test圈馬程式更新\">\r\n      <created>1672236353047</created>\r\n      <option name=\"number\" value=\"00052\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00052\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1672236353047</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00053\" summary=\"修改FRAME31.1~4的位置\">\r\n      <created>1675673976293</created>\r\n      <option name=\"number\" value=\"00053\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00053\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1675673976293</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00054\" summary=\"修改FRAME31.1~4的位置\">\r\n      <created>1675673982520</created>\r\n      <option name=\"number\" value=\"00054\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00054\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1675673982521</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00055\" summary=\"完成剖面圖投影&#10;局部放大圖Section view F-F需先切換視窗關閉零件再進行投影\">\r\n      <created>1675945568474</created>\r\n      <option name=\"number\" value=\"00055\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00055\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1675945568474</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00056\" summary=\"完成剖面圖投影&#10;局部放大圖Section view F-F需先切換視窗關閉零件再進行投影\">\r\n      <created>1675945584188</created>\r\n      <option name=\"number\" value=\"00056\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00056\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1675945584188</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00057\" summary=\"將py檔更換位置\">\r\n      <created>1675945931695</created>\r\n      <option name=\"number\" value=\"00057\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00057\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1675945931695</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00058\" summary=\"py檔更換位置\">\r\n      <created>1675993596851</created>\r\n      <option name=\"number\" value=\"00058\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00058\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1675993596851</updated>\r\n    </task>\r\n    <option name=\"localTasksCounter\" value=\"59\" />\r\n    <servers />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State />\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n    <option name=\"oldMeFiltersMigrated\" value=\"true\" />\r\n  </component>\r\n  <component name=\"VcsManagerConfiguration\">\r\n    <MESSAGE value=\"修改FRAME32結合距離及尺寸、氣壓缸結合距離\" />\r\n    <MESSAGE value=\"移除行程部分\" />\r\n    <MESSAGE value=\"SP移除閉合部分&#10;main_GUI新增判斷條件\" />\r\n    <MESSAGE value=\"新增結合零件&#10;新增Product存檔\" />\r\n    <MESSAGE value=\"新增標準件偏移結合\" />\r\n    <MESSAGE value=\"新增:爆炸圖尺寸更改\" />\r\n    <MESSAGE value=\"Merge remote-tracking branch 'origin/master'&#10;&#10;# Conflicts:&#10;#&#9;123.py&#10;#&#9;GUI/main_GUI.py\" />\r\n    <MESSAGE value=\"新增:爆炸圖圖面\" />\r\n    <MESSAGE value=\"新增:比例判別, 生成2D視圖\" />\r\n    <MESSAGE value=\"比例調整及判斷\" />\r\n    <MESSAGE value=\"完成爆炸圖前、左、右視圖\" />\r\n    <MESSAGE value=\"完成爆炸圖下半部比例位置自動調整\" />\r\n    <MESSAGE value=\"更改主檔爆炸圖下圖\" />\r\n    <MESSAGE value=\"完成爆炸圖比例位置偏移\" />\r\n    <MESSAGE value=\"修正爆炸圖比例偏移\" />\r\n    <MESSAGE value=\"建立及測試圈碼圖&#10;(Y方向卡關)\" />\r\n    <MESSAGE value=\"完成零件6圈碼圖建立\" />\r\n    <MESSAGE value=\"修改爆炸圖偏移二變數&#10;新增更改視圖名稱\" />\r\n    <MESSAGE value=\"N1及drafting_test更新\" />\r\n    <MESSAGE value=\"N1及N_test圈馬程式更新\" />\r\n    <MESSAGE value=\"修改main_GUI平板問題及離合器起飛問題\" />\r\n    <MESSAGE value=\"修改FRAME31.1~4的位置\" />\r\n    <MESSAGE value=\"完成剖面圖投影&#10;局部放大圖Section view F-F需先切換視窗關閉零件再進行投影\" />\r\n    <MESSAGE value=\"將py檔更換位置\" />\r\n    <MESSAGE value=\"py檔更換位置\" />\r\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"py檔更換位置\" />\r\n  </component>\r\n  <component name=\"XDebuggerManager\">\r\n    <breakpoint-manager>\r\n      <breakpoints>\r\n        <line-breakpoint enabled=\"true\" suspend=\"THREAD\" type=\"python-line\">\r\n          <url>file://$PROJECT_DIR$/SYEI_stamping_press_system/drafting.py</url>\r\n          <line>675</line>\r\n          <option name=\"timeStamp\" value=\"11\" />\r\n        </line-breakpoint>\r\n      </breakpoints>\r\n    </breakpoint-manager>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision 9b03e8114d34ddad78b2ae1878b096aad22932e2)
+++ b/.idea/workspace.xml	(date 1676271168270)
@@ -1,14 +1,15 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
   <component name="ChangeListManager">
-    <list default="true" id="16196f2d-2bed-4919-b6e6-decc4073d892" name="Changes" comment="py檔更換位置">
+    <list default="true" id="16196f2d-2bed-4919-b6e6-decc4073d892" name="Changes" comment="完成焊接圖所有投影，焊接符號標註及圈碼圖待完工">
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/SYEI_stamping_press_system/123.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/SYEI_stamping_press_system/FRAME_ASSEMBLY.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/SYEI_stamping_press_system/PY.py" beforeDir="false" />
       <change beforePath="$PROJECT_DIR$/SYEI_stamping_press_system/TEST.py" beforeDir="false" afterPath="$PROJECT_DIR$/SYEI_stamping_press_system/TEST.py" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/SYEI_stamping_press_system/drafting.py" beforeDir="false" afterPath="$PROJECT_DIR$/SYEI_stamping_press_system/drafting.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SYEI_stamping_press_system/file_path.py" beforeDir="false" afterPath="$PROJECT_DIR$/SYEI_stamping_press_system/file_path.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SYEI_stamping_press_system/main_GUI.py" beforeDir="false" afterPath="$PROJECT_DIR$/SYEI_stamping_press_system/main_GUI.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SYEI_stamping_press_system/main_program.py" beforeDir="false" afterPath="$PROJECT_DIR$/SYEI_stamping_press_system/main_program.py" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/SYEI_stamping_press_system/parameter.py" beforeDir="false" afterPath="$PROJECT_DIR$/SYEI_stamping_press_system/parameter.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SYEI_stamping_press_system/stamping_press/Drawing3.CATDrawing" beforeDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -56,8 +57,8 @@
       <recent name="C:\Users\User\PycharmProjects\stamping_press" />
     </key>
   </component>
-  <component name="RunManager" selected="Python.TEST (1)">
-    <configuration name="PY" type="PythonConfigurationType" factoryName="Python" temporary="true" nameIsGenerated="true">
+  <component name="RunManager" selected="Python.main_GUI">
+    <configuration name="TEST (1)" type="PythonConfigurationType" factoryName="Python" temporary="true" nameIsGenerated="true">
       <module name="Stamping press" />
       <option name="INTERPRETER_OPTIONS" value="" />
       <option name="PARENT_ENVS" value="true" />
@@ -65,11 +66,11 @@
         <env name="PYTHONUNBUFFERED" value="1" />
       </envs>
       <option name="SDK_HOME" value="" />
-      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
+      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$/SYEI_stamping_press_system" />
       <option name="IS_MODULE_SDK" value="true" />
       <option name="ADD_CONTENT_ROOTS" value="true" />
       <option name="ADD_SOURCE_ROOTS" value="true" />
-      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/PY.py" />
+      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/SYEI_stamping_press_system/TEST.py" />
       <option name="PARAMETERS" value="" />
       <option name="SHOW_COMMAND_LINE" value="false" />
       <option name="EMULATE_TERMINAL" value="false" />
@@ -78,7 +79,7 @@
       <option name="INPUT_FILE" value="" />
       <method v="2" />
     </configuration>
-    <configuration name="TEST (1)" type="PythonConfigurationType" factoryName="Python" temporary="true" nameIsGenerated="true">
+    <configuration name="TEST" type="PythonConfigurationType" factoryName="Python" temporary="true" nameIsGenerated="true">
       <module name="Stamping press" />
       <option name="INTERPRETER_OPTIONS" value="" />
       <option name="PARENT_ENVS" value="true" />
@@ -86,11 +87,11 @@
         <env name="PYTHONUNBUFFERED" value="1" />
       </envs>
       <option name="SDK_HOME" value="" />
-      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$/SYEI_stamping_press_system" />
+      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
       <option name="IS_MODULE_SDK" value="true" />
       <option name="ADD_CONTENT_ROOTS" value="true" />
       <option name="ADD_SOURCE_ROOTS" value="true" />
-      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/SYEI_stamping_press_system/TEST.py" />
+      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/TEST.py" />
       <option name="PARAMETERS" value="" />
       <option name="SHOW_COMMAND_LINE" value="false" />
       <option name="EMULATE_TERMINAL" value="false" />
@@ -99,7 +100,7 @@
       <option name="INPUT_FILE" value="" />
       <method v="2" />
     </configuration>
-    <configuration name="TEST" type="PythonConfigurationType" factoryName="Python" temporary="true" nameIsGenerated="true">
+    <configuration name="drafting" type="PythonConfigurationType" factoryName="Python" temporary="true" nameIsGenerated="true">
       <module name="Stamping press" />
       <option name="INTERPRETER_OPTIONS" value="" />
       <option name="PARENT_ENVS" value="true" />
@@ -107,11 +108,11 @@
         <env name="PYTHONUNBUFFERED" value="1" />
       </envs>
       <option name="SDK_HOME" value="" />
-      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
+      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$/SYEI_stamping_press_system" />
       <option name="IS_MODULE_SDK" value="true" />
       <option name="ADD_CONTENT_ROOTS" value="true" />
       <option name="ADD_SOURCE_ROOTS" value="true" />
-      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/TEST.py" />
+      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/SYEI_stamping_press_system/drafting.py" />
       <option name="PARAMETERS" value="" />
       <option name="SHOW_COMMAND_LINE" value="false" />
       <option name="EMULATE_TERMINAL" value="false" />
@@ -164,11 +165,11 @@
     </configuration>
     <recent_temporary>
       <list>
-        <item itemvalue="Python.TEST (1)" />
         <item itemvalue="Python.main_GUI" />
+        <item itemvalue="Python.TEST (1)" />
+        <item itemvalue="Python.drafting" />
         <item itemvalue="Python.drafting_part" />
         <item itemvalue="Python.TEST" />
-        <item itemvalue="Python.PY" />
       </list>
     </recent_temporary>
   </component>
@@ -180,13 +181,6 @@
       <option name="number" value="Default" />
       <option name="presentableId" value="Default" />
       <updated>1668131959961</updated>
-    </task>
-    <task id="LOCAL-00010" summary="新增test機架零件變數變換和機架組和更新">
-      <created>1668516189353</created>
-      <option name="number" value="00010" />
-      <option name="presentableId" value="LOCAL-00010" />
-      <option name="project" value="LOCAL" />
-      <updated>1668516189353</updated>
     </task>
     <task id="LOCAL-00011" summary="新增test機架零件變數變換和機架組和更新">
       <created>1668519506744</created>
@@ -524,7 +518,14 @@
       <option name="project" value="LOCAL" />
       <updated>1675993596851</updated>
     </task>
-    <option name="localTasksCounter" value="59" />
+    <task id="LOCAL-00059" summary="完成焊接圖所有投影，焊接符號標註及圈碼圖待完工">
+      <created>1676024769331</created>
+      <option name="number" value="00059" />
+      <option name="presentableId" value="LOCAL-00059" />
+      <option name="project" value="LOCAL" />
+      <updated>1676024769331</updated>
+    </task>
+    <option name="localTasksCounter" value="60" />
     <servers />
   </component>
   <component name="Vcs.Log.Tabs.Properties">
@@ -540,7 +541,6 @@
     <option name="oldMeFiltersMigrated" value="true" />
   </component>
   <component name="VcsManagerConfiguration">
-    <MESSAGE value="修改FRAME32結合距離及尺寸、氣壓缸結合距離" />
     <MESSAGE value="移除行程部分" />
     <MESSAGE value="SP移除閉合部分&#10;main_GUI新增判斷條件" />
     <MESSAGE value="新增結合零件&#10;新增Product存檔" />
@@ -565,17 +565,7 @@
     <MESSAGE value="完成剖面圖投影&#10;局部放大圖Section view F-F需先切換視窗關閉零件再進行投影" />
     <MESSAGE value="將py檔更換位置" />
     <MESSAGE value="py檔更換位置" />
-    <option name="LAST_COMMIT_MESSAGE" value="py檔更換位置" />
-  </component>
-  <component name="XDebuggerManager">
-    <breakpoint-manager>
-      <breakpoints>
-        <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
-          <url>file://$PROJECT_DIR$/SYEI_stamping_press_system/drafting.py</url>
-          <line>675</line>
-          <option name="timeStamp" value="11" />
-        </line-breakpoint>
-      </breakpoints>
-    </breakpoint-manager>
+    <MESSAGE value="完成焊接圖所有投影，焊接符號標註及圈碼圖待完工" />
+    <option name="LAST_COMMIT_MESSAGE" value="完成焊接圖所有投影，焊接符號標註及圈碼圖待完工" />
   </component>
 </project>
\ No newline at end of file
Index: SYEI_stamping_press_system/main_program.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import os\r\nimport win32com.client as win32\r\nimport datetime, time\r\nimport file_path as fp\r\nimport zipfile as zf\r\n\r\n\r\n# 開啟CATIA(由學長提供之函式)\r\nclass set_CATIA_workbench_env:\r\n    def __init__(self):\r\n        # self.catapp = win32.Dispatch(\"CATIA.Application\")\r\n        self.env_name = {'Part_Design': 'PrtCfg', 'Product_Assembly': 'Assembly',\r\n                         'Generative_Sheetmetal_Design': 'SmdNewDesignWorkbench', 'Drafting': 'Drw'}\r\n        self.catapp = win32.Dispatch(\"CATIA.Application\")\r\n        # add some CATIA-specific settings here (Seeing CATIA Automation manual-Application section)\r\n        self.catapp.DisplayFileAlerts = False\r\n        self.catapp.Visible = True\r\n\r\n    def Part_Design(self):\r\n        self.catapp.Visible = True\r\n        self.catapp.StartWorkbench(self.env_name[self.Part_Design.__name__])\r\n        try:\r\n            temp = self.catapp.ActiveDocument\r\n            temp.close()\r\n        except:\r\n            pass\r\n        return\r\n\r\n    def Product_Assembly(self):\r\n        self.catapp.Visible = True\r\n        self.catapp.StartWorkbench(self.env_name[self.Product_Assembly.__name__])\r\n        try:\r\n            temp = self.catapp.ActiveDocument\r\n            temp.close()\r\n        except:\r\n            pass\r\n        return\r\n\r\n    def Generative_Sheetmetal_Design(self):\r\n        self.catapp.Visible = True\r\n        self.catapp.StartWorkbench(self.env_name[self.Generative_Sheetmetal_Design.__name__])\r\n        try:\r\n            temp = self.catapp.ActiveDocument\r\n            temp.close()\r\n        except:\r\n            pass\r\n        return\r\n\r\n    def Drafting(self):\r\n        self.catapp.Visible = True\r\n        self.catapp.StartWorkbench(self.env_name[self.Drafting.__name__])\r\n        try:\r\n            temp = self.catapp.ActiveDocument\r\n            temp.close()\r\n        except:\r\n            pass\r\n        return\r\n\r\n# 開啟組合檔\r\ndef assembly_create():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    documents1 = catapp.Documents\r\n    productDocument1 = documents1.Add(\"Product\")\r\n\r\n# 匯入組合檔\r\ndef import_file_Product(path, file_name):  # (資料夾路徑，檔案名稱)\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    productDocument1 = catapp.ActiveDocument\r\n    product1 = productDocument1.Product\r\n    products1 = product1.Products\r\n    products1Variant = products1\r\n    combination_file = []  # 組合檔\r\n    combination_file.append(path + '\\\\' + file_name + '.CATProduct')\r\n    products1Variant.AddComponentsFromFiles(combination_file, \"All\")\r\n\r\n# 匯入零件檔\r\ndef import_file_Part(path, file_name):  # (資料夾路徑，檔案名稱)\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    productDocument1 = catapp.ActiveDocument\r\n    product1 = productDocument1.Product\r\n    products1 = product1.Products\r\n    products1Variant = products1\r\n    combination_file = []  # 組合檔\r\n    combination_file.append(path + '\\\\' + file_name + '.CATPart')\r\n    products1Variant.AddComponentsFromFiles(combination_file, \"All\")\r\n\r\n# 匯入組合檔\r\ndef import_file_Product(path, file_name):  # (資料夾路徑，檔案名稱)\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    productDocument1 = catapp.ActiveDocument\r\n    product1 = productDocument1.Product\r\n    products1 = product1.Products\r\n    products1Variant = products1\r\n    combination_file = []  # 組合檔\r\n    combination_file.append(path + '\\\\' + file_name + '.CATProduct')\r\n    products1Variant.AddComponentsFromFiles(combination_file, \"All\")\r\n\r\ndef folder_file_name():  # 抓取檔案名稱\r\n    path = os.listdir(fp.system_root + fp.part)\r\n    x = []\r\n    for file_name in path:\r\n        x.append('or y == \\'' + file_name.split('.')[0] + '\\'')\r\n        print(' '.join(x))\r\n\r\n# frame名稱\r\ndef frame_name():\r\n    x = []\r\n    for a in range(1, 44):\r\n        x.append('FRAME' + str(a))\r\n    print(x)\r\n\r\n# 偏移組合檔_0(0表示OPPOSITE)\r\ndef add_offset_assembly_0(element1, element2, element3, element4, element5, dist, relation):  # (組合檔1, 零件1, 組合檔2, 零件2, 距離, 結合面)\r\n    catapp = win32.Dispatch(\"CATIA.Application\")\r\n    productdoc = catapp.ActiveDocument\r\n    product = productdoc.Product\r\n    product = product.ReferenceProduct\r\n    constraints = product.Connections(\"CATIAConstraints\")\r\n    ref1 = product.CreateReferenceFromName(\r\n        \"Product1/%s.1/%s/!PartBody/!%s\" % (element1, element2, relation))  # (將%指定檔內容移入%s)\r\n    ref2 = product.CreateReferenceFromName(\r\n        \"Product1/%s.1/%s.1/%s/!PartBody/!%s\" % (element3, element4, element5, relation))\r\n    constraint = constraints.AddBiEltCst(1, ref1, ref2)  # (1表示偏移拘束, ref1, ref2)\r\n    length = constraint.Dimension\r\n    length.value = dist\r\n    constraint.Orientation = 0\r\n    product.Update()\r\n    return True\r\n\r\n# 偏移組合檔_1(1表示SAME)\r\ndef add_offset_assembly_1(element1, element2, element3, element4, element5, dist, relation):  # (組合檔1, 零件1, 組合檔2, 零件2, 距離, 結合面)\r\n    catapp = win32.Dispatch(\"CATIA.Application\")\r\n    productdoc = catapp.ActiveDocument\r\n    product = productdoc.Product\r\n    product = product.ReferenceProduct\r\n    constraints = product.Connections(\"CATIAConstraints\")\r\n    ref1 = product.CreateReferenceFromName(\r\n        \"Product1/%s.1/%s/!PartBody/!%s\" % (element1, element2, relation))  # (將%指定檔內容移入%s)\r\n    ref2 = product.CreateReferenceFromName(\r\n        \"Product1/%s.1/%s.1/%s/!PartBody/!%s\" % (element3, element4, element5, relation))\r\n    constraint = constraints.AddBiEltCst(1, ref1, ref2)  # (1表示偏移拘束, ref1, ref2)\r\n    length = constraint.Dimension\r\n    length.value = dist\r\n    constraint.Orientation = 1\r\n    product.Update()\r\n    return True\r\n\r\ndef combination_file_open(target, dir):\r\n    # 連結CATIA\r\n    catapp = win32.Dispatch(\"CATIA.Application\")\r\n    document = catapp.Documents\r\n    # 將路徑設為目錄的文字宣告\r\n    directory = str(dir)\r\n    # directory = '\\\\'.join(directory.split('/'))\r\n    print(directory)\r\n    # gvar.folderdir = directory\r\n    # 定義零件檔檔名\r\n    part_dir = directory + target + '.CATProduct'\r\n    print(part_dir)\r\n    # partdoc = document.Open(\"%s%s.%s\" % (directory,target,\"CATPart\"))\r\n    # 開啟該零件檔\r\n    partdoc = document.Open(part_dir)\r\n    return target + '.CATPart'\r\n\r\ndef param_change(file_name, target, value):\r\n    catapp = win32.Dispatch(\"CATIA.Application\")\r\n    productDocument = catapp.ActiveDocument\r\n    product = productDocument.Product\r\n    product = product.ReferenceProduct\r\n    documents = catapp.Documents\r\n    partDocument = documents.Item(file_name + \".CATPart\")\r\n    part = partDocument.Part\r\n    parameter = part.Parameters\r\n    # 按照變數尺寸修改板件長度\r\n    length = parameter.Item(target)\r\n    length.Value = value\r\n    productDocument = catapp.ActiveDocument\r\n    part.Update()\r\n\r\n# FRAME結合尺寸parameter, parameter_dimension, combined_number\r\ndef combined_dimension(combination_number, combined_dimension):  # 組合編號, 組合尺寸\r\n    catapp = win32.Dispatch(\"CATIA.Application\")\r\n    productDocument = catapp.ActiveDocument\r\n    product = productDocument.Product\r\n    constraints = product.Connections(\"CATIAConstraints\")\r\n    constraint = constraints.Item(combination_number)\r\n    length = constraint.Dimension\r\n    length.Value = combined_dimension\r\n    constraint.Orientation = 1\r\n    product.Update()\r\n\r\n# 零件檔修改\r\ndef import_part(path, file_name):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    documents1 = catapp.Documents\r\n    partDocument1 = documents1.Open(path + \"\\\\\" + file_name + \".CATPart\")\r\n\r\ndef import_product(path, file_name):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    documents1 = catapp.Documents\r\n    partDocument1 = documents1.Open(path + \"\\\\\" + file_name + \".CATProduct\")\r\n\r\n#零件檔存檔\r\ndef save_file_part(path, file_name):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    document = catapp.Documents\r\n    file_name = file_name + '.CATPart'\r\n    partDocument1 = document.Item(file_name)\r\n    # print(path + '\\\\' + file_name)\r\n    partDocument1.SaveAs(path + '\\\\' + file_name)\r\n    partDocument1.Close()\r\n\r\n#組合檔存檔\r\ndef save_file_product(path, file_name):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    document = catapp.Documents\r\n    file_name = file_name + '.CATProduct'\r\n    partDocument1 = document.Item(file_name)\r\n    # print(path + '\\\\' + file_name)\r\n    partDocument1.SaveAs(path + '\\\\' + file_name)\r\n\r\n# 新增資料夾\r\ndef new_Folder():\r\n    time = datetime.datetime.now()\r\n    print(time.day, time.hour, time.minute, time.second)\r\n    dir = 'stamping_press' + '_' + str(time.month) + '_' + str(time.day) + '_' + str(time.hour) + '_' + str(time.minute) + '_' + str(time.second)\r\n    path = 'C:\\\\Users\\\\USER\\\\Desktop' + '\\\\' + dir\r\n    os.mkdir(path)\r\n    return path, dir\r\n\r\n# 偏移組合檔(零件結合)\r\ndef add_offset_assembly(element1, element2, dist, relation, binding_conditions, name):  # (組合檔1, 零件1, 組合檔2, 零件2, 距離, 結合面, 拘束條件)\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    productDocument = catapp.ActiveDocument\r\n    product = productDocument.Product\r\n    constraints = product.Connections(\"CATIAConstraints\")\r\n    ref1 = product.CreateReferenceFromName(\"Product1/%s/!PartBody/!%s\" % (element1, relation))  # (將%指定檔內容移入%s)\r\n    ref2 = product.CreateReferenceFromName(\"Product1/%s/!PartBody/!%s\" % (element2, relation))\r\n    constraint = constraints.AddBiEltCst(1, ref1, ref2)  # (1表示偏移拘束, ref1, ref2)\r\n    length = constraint.Dimension\r\n    length.value = dist\r\n    constraint.Orientation = binding_conditions  # (1表示SAME, 0表示OPPOSITE)\r\n    constraint.Name = name\r\n    return True\r\n\r\n# 偏移組合檔(標準件與零件結合)\r\ndef add_offset_product_assembly(element1, element2, element3, dist, relation, binding_conditions, name):  # (組合檔1, 零件1, 組合檔2, 零件2, 距離, 結合面, 拘束條件)\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    productDocument = catapp.ActiveDocument\r\n    product = productDocument.Product\r\n    constraints = product.Connections(\"CATIAConstraints\")\r\n    ref1 = product.CreateReferenceFromName(\"Product1/%s/!%s/%s\" % (element1, element2, relation))  # (將%指定檔內容移入%s)\r\n    ref2 = product.CreateReferenceFromName(\"Product1/%s/!PartBody/%s\" % (element3, relation))\r\n    constraint = constraints.AddBiEltCst(1, ref1, ref2)  # (1表示偏移拘束, ref1, ref2)\r\n    length = constraint.Dimension\r\n    length.value = dist\r\n    constraint.Orientation = binding_conditions  # (1表示SAME, 0表示OPPOSITE)\r\n    constraint.Name = name\r\n    return True\r\n\r\ndef base_lock(element1, element2, name):  # 定海神針, 固定基準零件\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    productDocument = catapp.ActiveDocument\r\n    product = productDocument.Product\r\n    constraints = product.Connections(\"CATIAConstraints\")\r\n    ref = product.CreateReferenceFromName(\"Product1/%s/!Product1/%s/\" % (element1, element2))\r\n    constraint = constraints.AddMonoEltCst(0, ref)\r\n    constraint.Name = name\r\n    return True\r\n\r\ndef update():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    productDocument = catapp.ActiveDocument\r\n    product = productDocument.Product\r\n    product.Update()\r\n    specsAndGeomWindow = catapp.ActiveWindow\r\n    viewer3D = specsAndGeomWindow.ActiveViewer\r\n    viewer3D.Reframe()\r\n\r\n# 組合拘束隱藏\r\ndef hide_ass_all_Constraint():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    document = catapp.Documents\r\n    drawingdocument = catapp.ActiveDocument\r\n    selection1 = drawingdocument.Selection\r\n    selection1.Search(\"Type='Assembly Design'.Constraint,all\")\r\n    selection1.VisProperties.SetShow(1)\r\n    selection1.Clear()\r\n    selection1.Search(\"Type='Part Design'.Plane,all\")\r\n    selection1.VisProperties.SetShow(1)\r\n    selection1.Clear()\r\n\r\ndef axis_system():#開啟座標軸\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    Part = catapp.ActiveDocument.Part\r\n    AxisSystems = Part.AxisSystems\r\n    AxisSystem = AxisSystems.Add()\r\n    Hybridbodys = Part.HybridBodies\r\n    Part.Update()\r\n\r\ndef scaling(X):  # 零件等比例縮小\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    partDocument = catapp.ActiveDocument\r\n    part = partDocument.Part\r\n    shapeFactory = part.ShapeFactory\r\n    axisSystems = part.AxisSystems\r\n    axisSystem = axisSystems.Item(\"Axis System.1\")\r\n    reference = part.CreateReferenceFromBRepName(\r\n        \"FVertex:(Vertex:(Neighbours:(Face:(Brp:(AxisSystem.1;2);None:();Cf11:());Face:(Brp:(AxisSystem.1;3);None:();Cf11:());Face:(Brp:(AxisSystem.1;1);None:();Cf11:()));Cf11:());WithPermanentBody;WithoutBuildError;WithSelectingFeatureSupport;MFBRepVersion_CXR15)\",\r\n        axisSystem)\r\n    scaling = shapeFactory.AddNewScaling2(reference, X)\r\n    part.InWorkObject = scaling\r\n    part.Update()\r\n\r\n# 關閉實體外所有東西\r\ndef Close_All():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    partdocument1 = catapp.ActiveDocument\r\n    selection1 = partdocument1.Selection\r\n    selection1.Search(\r\n        \"((((((((CATStFreeStyleSearch.OpenBodyFeature + CATPrtSearch.OpenBodyFeature) + CATGmoSearch.OpenBodyFeature) + CATSpdSearch.OpenBodyFeature) + CATPrtSearch.Sketch + CATPrtSearch.Plane) + CATPrtSearch.MfConstraint) + CATPrtSearch.AxisSystem) + CATPrtSearch.Point) + CATPrtSearch.Line),all\")\r\n    visPropertySet1 = selection1.VisProperties\r\n    visPropertySet1.SetShow(1)\r\n\r\ndef del_ass_all_Constraint():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    document = catapp.Documents\r\n    drawingdocument = catapp.ActiveDocument\r\n    selection1 = drawingdocument.Selection\r\n    selection1.Search(\"Type='Assembly Design'.Constraint,all\")\r\n    selection1.VisProperties.SetShow(1)\r\n    selection1.Delete()\r\n\r\ndef saveas(save_dir, target, data_type):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    document = catapp.Documents\r\n    try:\r\n        saveas = document.Item('%s%s' % (target, data_type))\r\n        saveas.SaveAs('%s\\%s%s' % (save_dir, target, data_type))\r\n    except:\r\n        saveas = catapp.ActiveDocument\r\n        saveas.SaveAs('%s\\%s%s' % (save_dir, target, data_type))\r\n    finally:\r\n        saveas.Save()\r\n\r\ndef PDF_save(save_dir, name):\r\n    catapp = win32.Dispatch(\"CATIA.Application\")\r\n    partdoc = catapp.ActiveDocument\r\n    # 儲存檔案後關閉\r\n    partdoc.ExportData(\"%s\\%s.%s\" % (save_dir, name, \"pdf\"),\"pdf\")\r\n\r\ndef constaint_value_change(constraints_name, value, Orientation):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    productDocument = catapp.ActiveDocument\r\n    product = productDocument.Product\r\n    product = product.ReferenceProduct\r\n    constraints = product.Connections(\"CATIAConstraints\")\r\n    constraint = constraints.Item(str(constraints_name))\r\n    length = constraint.Dimension\r\n    length.Value = value\r\n    constraint.Orientation = Orientation\r\n\r\ndef OPEN_Drawing():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    documents = catapp.Documents\r\n    drawingDocument = documents.Open(fp.system_root + fp.part + fp.Exploded_Views)\r\n\r\ndef OPEN_detail_drawing():\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    documents = catapp.Documents\r\n    drawingDocument = documents.Open(fp.system_root + fp.part + fp.detail_drawing)\r\n\r\n#零件圖存檔\r\ndef save_detail_drawing(path, file_name):\r\n    catapp = win32.Dispatch('CATIA.Application')\r\n    document = catapp.Documents\r\n    file_name = file_name + '.CATDrawing'\r\n    partDocument2 = document.Item(file_name)\r\n    # print(path + '\\\\' + file_name)\r\n    partDocument2.SaveAs(path + '\\\\' + file_name)\r\n    partDocument2.Close()\r\n\r\ndef switch_window():\r\n    catapp = win32.Dispatch(\"CATIA.Application\")\r\n    specsAndGeomWindow1 = catapp.ActiveWindow\r\n    specsAndGeomWindow1.ActivateNext()\r\n\r\ndef hide_show_part(part_name, hide_show):  # 隱藏零件\r\n    catapp = win32.Dispatch(\"CATIA.Application\")\r\n    productDocument1 = catapp.ActiveDocument\r\n    selection1 = productDocument1.Selection\r\n    visPropertySet1 = selection1.VisProperties\r\n    product1 = productDocument1.Product\r\n    products1 = product1.Products\r\n    product2 = products1.Item(part_name + '.1')\r\n    products1 = product2.Parent\r\n    selection1.Add(product2)\r\n    visPropertySet1 = visPropertySet1.Parent\r\n    visPropertySet1.SetShow(hide_show)  # 隱藏1, 顯示0\r\n    selection1.Clear()\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SYEI_stamping_press_system/main_program.py b/SYEI_stamping_press_system/main_program.py
--- a/SYEI_stamping_press_system/main_program.py	(revision 9b03e8114d34ddad78b2ae1878b096aad22932e2)
+++ b/SYEI_stamping_press_system/main_program.py	(date 1676254714135)
@@ -370,6 +370,15 @@
     documents = catapp.Documents
     drawingDocument = documents.Open(fp.system_root + fp.part + fp.detail_drawing)
 
+def OPEN_Welding_diagram():
+    catapp = win32.Dispatch('CATIA.Application')
+    documents = catapp.Documents
+    drawingDocument = documents.Open(fp.system_root + fp.part + fp.Welding_diagram)
+
+def Close_all_window():
+    catapp = win32.Dispatch('CATIA.Application')
+
+
 #零件圖存檔
 def save_detail_drawing(path, file_name):
     catapp = win32.Dispatch('CATIA.Application')
